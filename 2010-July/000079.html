<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiezatlas-svn] r91 - in trunk: docs images pages src/de	src/de/kiezatlas/deepamehta src/de/kiezatlas/deepamehta/topics
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiezatlas-svn/2010-July/index.html" >
   <LINK REL="made" HREF="mailto:kiezatlas-svn%40lists.berlios.de?Subject=Re%3A%20%5BKiezatlas-svn%5D%20r91%20-%20in%20trunk%3A%20docs%20images%20pages%20src/de%0A%09src/de/kiezatlas/deepamehta%20src/de/kiezatlas/deepamehta/topics&In-Reply-To=%3C20100709230645.9287548063F%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000080.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiezatlas-svn] r91 - in trunk: docs images pages src/de	src/de/kiezatlas/deepamehta src/de/kiezatlas/deepamehta/topics</H1>
    <B>maltito at mail.berlios.de</B> 
    <A HREF="mailto:kiezatlas-svn%40lists.berlios.de?Subject=Re%3A%20%5BKiezatlas-svn%5D%20r91%20-%20in%20trunk%3A%20docs%20images%20pages%20src/de%0A%09src/de/kiezatlas/deepamehta%20src/de/kiezatlas/deepamehta/topics&In-Reply-To=%3C20100709230645.9287548063F%40sheep.berlios.de%3E"
       TITLE="[Kiezatlas-svn] r91 - in trunk: docs images pages src/de	src/de/kiezatlas/deepamehta src/de/kiezatlas/deepamehta/topics">maltito at mail.berlios.de
       </A><BR>
    <I>Sat Jul 10 01:06:45 CEST 2010</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000080.html">[Kiezatlas-svn] r92 - in trunk: pages src/de/kiezatlas/deepamehta	src/de/kiezatlas/deepamehta/topics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79">[ date ]</a>
              <a href="thread.html#79">[ thread ]</a>
              <a href="subject.html#79">[ subject ]</a>
              <a href="author.html#79">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: maltito
Date: 2010-07-10 01:06:45 +0200 (Sat, 10 Jul 2010)
New Revision: 91

Added:
   trunk/images/back-arrow.gif
   trunk/images/document-save.png
   trunk/images/export.png
   trunk/images/pow-in-numbers-bright.png
   trunk/images/pow-in-numbers-dark.png
   trunk/images/reload.png
   trunk/images/slimList.png
   trunk/pages/jQuery-min.1.4.2.js
Removed:
   trunk/src/de/rpc/
Modified:
   trunk/docs/session.txt
   trunk/pages/CityMap.jsp
   trunk/pages/GeoObjectList.jsp
   trunk/pages/ImportsHome.jsp
   trunk/pages/KiezAtlas.jsp
   trunk/pages/ListMailing.jsp
   trunk/pages/util.js
   trunk/src/de/kiezatlas/deepamehta/BrowseServlet.java
   trunk/src/de/kiezatlas/deepamehta/ImportServlet.java
   trunk/src/de/kiezatlas/deepamehta/ImportWorker.java
   trunk/src/de/kiezatlas/deepamehta/KiezAtlas.java
   trunk/src/de/kiezatlas/deepamehta/KiezServlet.java
   trunk/src/de/kiezatlas/deepamehta/ListServlet.java
   trunk/src/de/kiezatlas/deepamehta/topics/CityMapTopic.java
Log:
Several Enhancements introduced for Kiezatlas Version 1.6.5
- Introduced Numbering within GeoObjectInfoLists and CityMap at the /browse-Interface
- Improved Roundmail Feature, 
- Several (but minor) changes to the ImportWorker for Ehrenamt, e.g. if ParserCheck fails for any reason, import is skipped
- documented some changes in session.txt

Notes: 
- the /browse-interface now loads the jQuery-library
- icons in use were added
- removed unused directories in /src/..


Modified: trunk/docs/session.txt
===================================================================
--- trunk/docs/session.txt	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/docs/session.txt	2010-07-09 23:06:45 UTC (rev 91)
@@ -41,6 +41,8 @@
 							element 1,2,..: PresentableTopic
 cluster				Vector of Clusters
 selectedGeo			GeoObject
+selectedCatId       If not null, or an empty string it is the index of the selectedCat in the hotspotsVector
+enumerationFlag     If true, numberedLabels are shown next to the GeoObjects of the selectedCat
 
 
 CategoryList

Added: trunk/images/back-arrow.gif
===================================================================
(Binary files differ)


Property changes on: trunk/images/back-arrow.gif
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/images/document-save.png
===================================================================
(Binary files differ)


Property changes on: trunk/images/document-save.png
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/images/export.png
===================================================================
(Binary files differ)


Property changes on: trunk/images/export.png
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/images/pow-in-numbers-bright.png
===================================================================
(Binary files differ)


Property changes on: trunk/images/pow-in-numbers-bright.png
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/images/pow-in-numbers-dark.png
===================================================================
(Binary files differ)


Property changes on: trunk/images/pow-in-numbers-dark.png
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/images/reload.png
===================================================================
(Binary files differ)


Property changes on: trunk/images/reload.png
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Added: trunk/images/slimList.png
===================================================================
(Binary files differ)


Property changes on: trunk/images/slimList.png
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Modified: trunk/pages/CityMap.jsp
===================================================================
--- trunk/pages/CityMap.jsp	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/pages/CityMap.jsp	2010-07-09 23:06:45 UTC (rev 91)
@@ -5,6 +5,8 @@
 	Vector shapeTypes = (Vector) session.getAttribute(&quot;shapeTypes&quot;);
 	Vector shapes = (Vector) session.getAttribute(&quot;shapes&quot;);
 	Vector cluster = (Vector) session.getAttribute(&quot;cluster&quot;);
+    Boolean enumerationFlag = (Boolean) session.getAttribute(&quot;enumerationFlag&quot;);
+    String selectedCatId = (String) session.getAttribute(&quot;selectedCatId&quot;);
 	GeoObject selectedInst = (GeoObject) session.getAttribute(&quot;selectedGeo&quot;);
 	String stylesheet = (String) session.getAttribute(&quot;stylesheet&quot;);
 %&gt;
@@ -14,7 +16,14 @@
 	&lt;title&gt;Kiezatlas&lt;/title&gt;
 	&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
 	&lt;style type=&quot;text/css&quot;&gt;
-	&lt;%= stylesheet %&gt;
+        &lt;%= stylesheet %&gt;
+        &lt;%
+        if (enumerationFlag) {
+            out.println(&quot;\n.numbers { visibility: hidden; font: Arial, sans; color: #002755; background: #fff; font-size:12px; font-weight: bold; font-decoriation: none; }&quot;);
+        } else {
+            out.println(&quot;\n.numbers { visibility: hidden; }&quot;);
+        }
+        %&gt;
 	&lt;/style&gt;
 	&lt;!--[if lt IE 7]&gt;
 	&lt;script defer type=&quot;text/javascript&quot; src=&quot;../pages/pngfix.js&quot;&gt;&lt;/script&gt;
@@ -27,7 +36,7 @@
 		var YOffset = 0;
 		var XOffset = 0;
 
-		function showMenu(id) {			
+		function showMenu(id) {
 			if (currentActiveMenu != &quot;&quot;) {
 				hideMenu(currentActiveMenu);
 			}
@@ -50,7 +59,7 @@
 					currentActiveMenu = id;
 			}
 		}
-		
+
 		function hideMenu(id) {
 			if (document.getElementById) {
 				var currentMenu = &quot;clusterMenu&quot;+id;
@@ -68,7 +77,7 @@
 				return window.pageYOffset;
 			}
 		}
-		
+
 		function independentX() {
 			if (navigator.appName == &quot;Microsoft Internet Explorer&quot;) {
 			    if(navigator.appVersion.indexOf(&quot;7.0&quot;) != -1) return document.documentElement.scrollLeft;
@@ -76,7 +85,7 @@
 			} else {
 			    return window.pageXOffset;
 			}
-		}		
+		}
 
 	&lt;/script&gt;
 &lt;/head&gt;
@@ -114,20 +123,34 @@
 				}
 			}
 		}
-		
+
 		// --- geoObjects ---
 		e = hotspots.elements();
+        int catIndex = 0;
 		while (e.hasMoreElements()) {
 			Vector presentables = (Vector) e.nextElement();
 			Enumeration e2 = presentables.elements();
 			String icon = (String) e2.nextElement();
+            boolean enumerateThis = false;
+            int presentableIndex = 0;
+            if (selectedCatId != null) {
+                if (selectedCatId.equals(&quot;&quot;) || catIndex == Integer.parseInt(selectedCatId)) {
+                    enumerateThis = true;
+                }
+            }
+            catIndex++;
 			while (e2.hasMoreElements()) {
+                presentableIndex++;
+                //
 				PresentableTopic inst = (PresentableTopic) e2.nextElement();
 				Point p = inst.getGeometry();
 				out.println(&quot;&lt;a href=\&quot;javascript:top.frames.right.location.href='controller?action=&quot; +
 					KiezAtlas.ACTION_SHOW_GEO_INFO + &quot;&amp;id=&quot; + inst.getID() + &quot;'\&quot;&gt;&quot; +
 					&quot;&lt;img src=\&quot;&quot; + icon + &quot;\&quot; style=\&quot;position:absolute; top:&quot; + (p.y - 7) + &quot;px; left:&quot; +
-					(p.x - 7) + &quot;px;\&quot; alt=\&quot;&quot; + inst.getName() + &quot;\&quot; title=\&quot;&quot; + inst.getName() + &quot;\&quot; border=\&quot;0\&quot;&gt;&lt;/a&gt;&quot;);
+					(p.x - 7) + &quot;px;\&quot; alt=\&quot;&quot; + inst.getName() + &quot;\&quot; title=\&quot;&quot; + inst.getName() + &quot;\&quot; border=\&quot;0\&quot;&gt;&quot;);
+                    if (enumerateThis) {
+                        out.println(&quot;&lt;div id=\&quot;numbers\&quot; style=\&quot;position: absolute; top:&quot; + (p.y - 7) + &quot;px; left:&quot; + (p.x - 5) + &quot;px;\&quot; class=\&quot;numbers\&quot;&gt;&quot;+ presentableIndex +&quot;&lt;/div&gt;&lt;/a&gt;&quot;);
+                    }
 			}
 		}
 		// cluster icons

Modified: trunk/pages/GeoObjectList.jsp
===================================================================
--- trunk/pages/GeoObjectList.jsp	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/pages/GeoObjectList.jsp	2010-07-09 23:06:45 UTC (rev 91)
@@ -14,33 +14,40 @@
 		out.println(&quot;Suchergebnis &quot;);
 	}
         // --- ### align new back button at the right side
-	out.println(&quot;&lt;b&gt;&quot; + searchValue + &quot;&lt;/b&gt;&nbsp;&nbsp;&nbsp;&lt;a class=\&quot;small\&quot; href==\&quot;controller?action=&quot; + KiezAtlas.ACTION_SHOW_CATEGORIES + &quot;&amp;critNr=&quot; +selectedCriteria+ &quot;&gt;zur&uuml;ck&lt;/a&gt;&quot;);
-        out.println(&quot;&lt;div class=\&quot;small\&quot;&gt;&quot; + insts.size() + &quot; Objekte &quot;);
-	out.println(&quot;&lt;/div&gt;&quot;);
+	out.println(&quot;&lt;b&gt;&quot; + searchValue + &quot;&lt;/b&gt;&lt;br/&gt;&quot;);
+        out.println(&quot;&lt;div class=\&quot;small\&quot;&gt;&quot; + insts.size() + &quot; Objekte&nbsp;&nbsp;&nbsp;&nbsp;&quot;);
+        out.println(&quot;&lt;/div&gt;&quot;);
+        out.println(&quot;&lt;a style=\&quot;position:relative; top: 3px; left:215px;\&quot; href=\&quot;controller?action=&quot; + KiezAtlas.ACTION_SHOW_CATEGORIES + &quot;&amp;critNr=&quot; +selectedCriteria+ &quot;\&quot;&gt;&lt;img src=\&quot;<A HREF="http://www.kiezatlas.de/client/icons/back-arrow.gif\">http://www.kiezatlas.de/client/icons/back-arrow.gif\</A>&quot; height=\&quot;13\&quot; text=\&quot;zur&#252;ck\&quot; title=\&quot;zur&#252;ck\&quot; alt=\&quot;zur&#252;ck\&quot; border=\&quot;0\&quot;&gt;&lt;/a&gt;&quot;);
+        out.println(&quot;&lt;a class=\&quot;small\&quot; style=\&quot;position:relative; left:218px;\&quot; href=\&quot;controller?action=&quot; + KiezAtlas.ACTION_SHOW_CATEGORIES + &quot;&amp;critNr=&quot; +selectedCriteria+ &quot;\&quot;&gt;zur&uuml;ck&lt;/a&gt;&quot;);
+        out.println(&quot;&lt;a style=\&quot;position:relative; top: 4px; left:222px;\&quot; id=\&quot;enumeration\&quot; href=\&quot;javascript:toggleNumeration();\&quot;&gt;&lt;img src=\&quot;../images/pow-in-numbers-dark.png\&quot; height=\&quot;17\&quot; title=\&quot;Nummern einblenden\&quot; alt=\&quot;Nummern einblenden\&quot; border=\&quot;0\&quot;&gt;&lt;/a&gt;&quot;);
+        // out.println(&quot;&lt;a href=\&quot;controller?action=&quot; + KiezAtlas.ACTION_SHOW_CATEGORIES + &quot;&amp;critNr=&quot; +selectedCriteria+ &quot;&gt;zur&uuml;ck&lt;/a&gt;&quot;);
+	// out.println();
 	out.println(&quot;&lt;p&gt;&quot;);
 	// --- list of institutions ---
 	out.println(&quot;&lt;table cellpadding=\&quot;4\&quot; cellspacing=\&quot;0\&quot;&gt;&quot;);
 	Enumeration e = insts.elements();
+    int listIndex = 1;
 	while (e.hasMoreElements()) {
 		BaseTopic inst = (BaseTopic) e.nextElement();
 		out.println(&quot;&lt;tr valign=\&quot;top\&quot;&gt;&quot;);
 		out.println(&quot;&lt;td align=\&quot;right\&quot;&gt;&quot;);
-		topicImages((Vector) cats.get(inst.getID()), html, out);
+            topicImages((Vector) cats.get(inst.getID()), html, out);
 		out.println(&quot;&lt;/td&gt;&quot;);
-		out.println(&quot;&lt;td&gt;&quot;);
+		out.println(&quot;&lt;td&gt;&lt;span id=\&quot;numbers\&quot;&gt;&lt;b&gt;&quot; + listIndex + &quot;.&lt;/b&gt;&lt;/span&gt;&quot;);
 		out.println(&quot;&lt;a href=\&quot;controller?action=&quot; + KiezAtlas.ACTION_SHOW_GEO_INFO + &quot;&amp;id=&quot; + inst.getID() +
 			&quot;\&quot;&gt;&quot; + inst.getName() + &quot;&lt;/a&gt;&quot;);
 		// address
 		Hashtable address = (Hashtable) addresses.get(inst.getID());
-		
+
 		String street = (String) address.get(KiezAtlas.PROPERTY_STREET);
 	    String postcode = (String) address.get(KiezAtlas.PROPERTY_POSTAL_CODE);
 		String city = (String) address.get(KiezAtlas.PROPERTY_CITY);
 		out.println(&quot;&lt;br&gt;&lt;small&gt;&quot; + (street != null ? street + &quot;&nbsp;&nbsp;&nbsp;&quot; : &quot;&quot;) + (postcode != null ? postcode + &quot; &quot; : &quot;&quot;) + city + &quot;&lt;/small&gt;&quot;);
 		out.println(&quot;&lt;/td&gt;&quot;);
 		out.println(&quot;&lt;/tr&gt;&quot;);
+        listIndex++;
 	}
 	out.println(&quot;&lt;/table&gt;&quot;);
-	
+
 %&gt;
 &lt;% end(session, out); %&gt;

Modified: trunk/pages/ImportsHome.jsp
===================================================================
--- trunk/pages/ImportsHome.jsp	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/pages/ImportsHome.jsp	2010-07-09 23:06:45 UTC (rev 91)
@@ -16,7 +16,7 @@
 	//
     //Enumeration e = workspaces.elements();
     //while (e.hasMoreElements()) {
-		// BaseTopic workspace = (BaseTopic) e.nextElement();
+		//BaseTopic workspace = (BaseTopic) e.nextElement();
 		out.println(&quot;&lt;dt&gt;&lt;b&gt;&quot; + workspace.getName() + &quot;&lt;/b&gt; beinhaltet &quot;+geoObjects.size() +&quot; Projekte &lt;/dt&gt;&quot;);
 		Enumeration e2 = criterias.keys();
 		while (e2.hasMoreElements()) {
@@ -26,7 +26,7 @@
                 out.println(key.toString() + &quot; (&quot; +critInNumbers.toString()+ &quot;)&quot;);
             out.println(&quot;&lt;/dd&gt;&quot;);
 		}
-            // out.println(&quot;&lt;dd&gt;&lt;a href=\&quot;?action=&quot;+KiezAtlas.ACTION_RESET_CRITERIAS+&quot;&amp;workspaceId=&quot;+workspace.getID()+&quot;\&quot;&gt; resetCategories&lt;/a&gt;&lt;/dd&gt;&quot;);
+            out.println(&quot;&lt;dd&gt;&lt;a href=\&quot;?action=&quot;+KiezAtlas.ACTION_RESET_CRITERIAS+&quot;&amp;workspaceId=&quot;+workspace.getID()+&quot;\&quot;&gt; resetCategories&lt;/a&gt;&lt;/dd&gt;&quot;);
         out.println(&quot;&lt;/dl&gt;&quot;);
         if (workerThreadState.equals(&quot;NEW&quot;)) {
             out.println(&quot;&lt;p&gt;&lt;i&gt;&quot;);

Modified: trunk/pages/KiezAtlas.jsp
===================================================================
--- trunk/pages/KiezAtlas.jsp	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/pages/KiezAtlas.jsp	2010-07-09 23:06:45 UTC (rev 91)
@@ -77,6 +77,8 @@
 			&quot;&lt;meta http-equiv=\&quot;content-type\&quot; content=\&quot;text/html; charset=iso-8859-1\&quot;&gt;&quot; +
 			&quot;\r&lt;title&gt;Kiezatlas&lt;/title&gt;&quot; +
 			&quot;\r&lt;style type=\&quot;text/css\&quot;&gt;\r&quot; + stylesheet + &quot;\r&lt;/style&gt;\r&quot; +
+            &quot;\r&lt;script src=\&quot;../pages/jQuery-min.1.4.2.js\&quot; type=\&quot;text/javascript\&quot;&gt;&lt;/script&gt;\r&quot; +
+            &quot;\r&lt;script src=\&quot;../pages/util.js\&quot; type=\&quot;text/javascript\&quot;&gt;&lt;/script&gt;\r&quot; +
 			&quot;&lt;/head&gt;\r&quot; +
 			&quot;&lt;body&quot; + (refreshMap ? &quot; onLoad=\&quot;top.frames.left.location.href='controller?action=initFrame&amp;frame=&quot; +
 				KiezAtlas.FRAME_LEFT + &quot;'\&quot;&quot; : &quot;&quot;) + &quot;&gt;\r\r&quot;);
@@ -200,7 +202,7 @@
 			return html.toString();
 		}
 	}
-	
+
 	String googleLink(String street, String postalCode, String city) throws IOException {
 		// ### System.out.println(&quot;&gt;&gt;&gt; googleLink(): street=\&quot;&quot; + street + &quot;\&quot; postalCode=\&quot;&quot; + postalCode + &quot;\&quot; city=\&quot;&quot; + city + &quot;\&quot;&quot;);
 		StringBuffer html = new StringBuffer();
@@ -214,7 +216,7 @@
 		    return &quot;&quot;;
 		}
 	}
-	
+
 	String mailtoUrl(Vector mailboxes) {
 		Enumeration e = mailboxes.elements();
 		StringBuffer url = new StringBuffer();
@@ -232,9 +234,9 @@
 		//
 		return url.toString();
 	}
-	
+
 	// --
-	
+
 	String fieldOptions(TopicBean bean, String[] hiddenProps, String[] hiddenPropsContaining, String checked) {
 		StringBuffer html = new StringBuffer();
 		for (int j = 0; j &lt; hiddenProps.length; j++) {
@@ -275,7 +277,7 @@
 		}
 		return html.toString();
 	}
-	
+
 	// ---
 
 	boolean isSet(String str) {

Modified: trunk/pages/ListMailing.jsp
===================================================================
--- trunk/pages/ListMailing.jsp	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/pages/ListMailing.jsp	2010-07-09 23:06:45 UTC (rev 91)
@@ -12,7 +12,7 @@
 	String filterField = (String) session.getAttribute(&quot;filterField&quot;);
 	Vector filterFieldNames = (Vector) session.getAttribute(&quot;filterFieldNames&quot;);
 	String recipients = (String) session.getAttribute(&quot;recipients&quot;);
-    // 
+    //
     out.println(&quot;&lt;h3&gt;Filtern zum Erstellen einer Rundmail-Empf&auml;ngerliste im Stadtplan \&quot;&quot;+cityMapName+&quot;\&quot;&lt;/h3&gt;&quot;);
     out.println(&quot;&lt;div class=\&quot;small\&quot; style=\&quot;position: absolute; right: 75px;\&quot;&gt;&lt;a href=\&quot;?action=&quot;+KiezAtlas.ACTION_GO_HOME+&quot;\&quot;&gt;zur&uuml;ck&lt;/a&gt;&lt;/div&gt;&quot;);
     //
@@ -31,9 +31,9 @@
     // out.println(&quot;&lt;input type=\&quot;text\&quot; name=\&quot;filterText\&quot;&gt;\n&quot;);
     out.println(&quot;&lt;input type=\&quot;submit\&quot; value=\&quot;zum Verteiler hinzuf&uuml;gen\&quot;&gt;\n&quot;);
     out.println(&quot;&lt;/form&gt;\n&quot;);
+    out.println(&quot;&lt;p/&gt;&lt;b&gt;&lt;a href=\&quot;?action=&quot;+KiezAtlas.ACTION_FILTER_MAIL_ALL+&quot;&amp;cityMapID=&quot;+cityMapId+&quot;\&quot;&gt;Alle Adressen Hinzuf&#252;gen&lt;/a&gt;&lt;/b&gt;&quot;);
     if (!recipients.equals(&quot;&quot;)) {
-        out.println(&quot;&lt;p/&gt;&quot;);
-        out.println(&quot;&lt;b&gt;&lt;a href=\&quot;mailto:?bcc=&quot;+recipients+&quot;\&quot;&gt;Rundmail erstellen&lt;/a&gt;&quot;);
+        out.println(&quot;&lt;b&gt;&nbsp;&nbsp;&nbsp;&lt;a href=\&quot;mailto:?bcc=&quot;+recipients+&quot;\&quot;&gt;Rundmail erstellen&lt;/a&gt;&quot;);
         out.println(&quot;&nbsp;&nbsp;&nbsp;&lt;a href=\&quot;?action=&quot;+KiezAtlas.ACTION_FILTER_ROUNDMAILING+&quot;&amp;cityMapID=&quot;+cityMapId+&quot;\&quot;&gt;Empf&auml;ngerliste zur&uuml;cksetzen&lt;/a&gt;&lt;/b&gt;&quot;);
     }
 %&gt;

Added: trunk/pages/jQuery-min.1.4.2.js
===================================================================
--- trunk/pages/jQuery-min.1.4.2.js	                        (rev 0)
+++ trunk/pages/jQuery-min.1.4.2.js	2010-07-09 23:06:45 UTC (rev 91)
@@ -0,0 +1,154 @@
+/*!
+ * jQuery JavaScript Library v1.4.2
+ * <A HREF="http://jquery.com/">http://jquery.com/</A>
+ *
+ * Copyright 2010, John Resig
+ * Dual licensed under the MIT or GPL Version 2 licenses.
+ * <A HREF="http://jquery.org/license">http://jquery.org/license</A>
+ *
+ * Includes Sizzle.js
+ * <A HREF="http://sizzlejs.com/">http://sizzlejs.com/</A>
+ * Copyright 2010, The Dojo Foundation
+ * Released under the MIT, BSD, and GPL Licenses.
+ *
+ * Date: Sat Feb 13 22:33:48 2010 -0500
+ */
+(function(A,w){function ma(){if(!c.isReady){try{s.documentElement.doScroll(&quot;left&quot;)}catch(a){setTimeout(ma,1);return}c.ready()}}function Qa(a,b){b.src?c.ajax({url:b.src,async:false,dataType:&quot;script&quot;}):c.globalEval(b.text||b.textContent||b.innerHTML||&quot;&quot;);b.parentNode&amp;&amp;b.parentNode.removeChild(b)}function X(a,b,d,f,e,j){var i=a.length;if(typeof b===&quot;object&quot;){for(var o in b)X(a,o,b[o],f,e,d);return a}if(d!==w){f=!j&amp;&amp;f&amp;&amp;c.isFunction(d);for(o=0;o&lt;i;o++)e(a[o],b,f?d.call(a[o],o,e(a[o],b)):d,j);return a}return i?
+e(a[0],b):w}function J(){return(new Date).getTime()}function Y(){return false}function Z(){return true}function na(a,b,d){d[0].type=a;return c.event.handle.apply(b,d)}function oa(a){var b,d=[],f=[],e=arguments,j,i,o,k,n,r;i=c.data(this,&quot;events&quot;);if(!(a.liveFired===this||!i||!i.live||a.button&amp;&amp;a.type===&quot;click&quot;)){a.liveFired=this;var u=i.live.slice(0);for(k=0;k&lt;u.length;k++){i=u[k];i.origType.replace(O,&quot;&quot;)===a.type?f.push(i.selector):u.splice(k--,1)}j=c(a.target).closest(f,a.currentTarget);n=0;for(r=
+j.length;n&lt;r;n++)for(k=0;k&lt;u.length;k++){i=u[k];if(j[n].selector===i.selector){o=j[n].elem;f=null;if(i.preType===&quot;mouseenter&quot;||i.preType===&quot;mouseleave&quot;)f=c(a.relatedTarget).closest(i.selector)[0];if(!f||f!==o)d.push({elem:o,handleObj:i})}}n=0;for(r=d.length;n&lt;r;n++){j=d[n];a.currentTarget=j.elem;a.data=j.handleObj.data;a.handleObj=j.handleObj;if(j.handleObj.origHandler.apply(j.elem,e)===false){b=false;break}}return b}}function pa(a,b){return&quot;live.&quot;+(a&amp;&amp;a!==&quot;*&quot;?a+&quot;.&quot;:&quot;&quot;)+b.replace(/\./g,&quot;`&quot;).replace(/ /g,
+&quot;&amp;&quot;)}function qa(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function ra(a,b){var d=0;b.each(function(){if(this.nodeName===(a[d]&amp;&amp;a[d].nodeName)){var f=c.data(a[d++]),e=c.data(this,f);if(f=f&amp;&amp;f.events){delete e.handle;e.events={};for(var j in f)for(var i in f[j])c.event.add(this,j,f[j][i],f[j][i].data)}}})}function sa(a,b,d){var f,e,j;b=b&amp;&amp;b[0]?b[0].ownerDocument||b[0]:s;if(a.length===1&amp;&amp;typeof a[0]===&quot;string&quot;&amp;&amp;a[0].length&lt;512&amp;&amp;b===s&amp;&amp;!ta.test(a[0])&amp;&amp;(c.support.checkClone||!ua.test(a[0]))){e=
+true;if(j=c.fragments[a[0]])if(j!==1)f=j}if(!f){f=b.createDocumentFragment();c.clean(a,b,f,d)}if(e)c.fragments[a[0]]=j?f:1;return{fragment:f,cacheable:e}}function K(a,b){var d={};c.each(va.concat.apply([],va.slice(0,b)),function(){d[this]=a});return d}function wa(a){return&quot;scrollTo&quot;in a&amp;&amp;a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:false}var c=function(a,b){return new c.fn.init(a,b)},Ra=A.jQuery,Sa=A.$,s=A.document,T,Ta=/^[^&lt;]*(&lt;[\w\W]+&gt;)[^&gt;]*$|^#([\w-]+)$/,Ua=/^.[^:#\[\.,]*$/,Va=/\S/,
+Wa=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,Xa=/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;)?$/,P=navigator.userAgent,xa=false,Q=[],L,$=Object.prototype.toString,aa=Object.prototype.hasOwnProperty,ba=Array.prototype.push,R=Array.prototype.slice,ya=Array.prototype.indexOf;c.fn=c.prototype={init:function(a,b){var d,f;if(!a)return this;if(a.nodeType){this.context=this[0]=a;this.length=1;return this}if(a===&quot;body&quot;&amp;&amp;!b){this.context=s;this[0]=s.body;this.selector=&quot;body&quot;;this.length=1;return this}if(typeof a===&quot;string&quot;)if((d=Ta.exec(a))&amp;&amp;
+(d[1]||!b))if(d[1]){f=b?b.ownerDocument||b:s;if(a=Xa.exec(a))if(c.isPlainObject(b)){a=[s.createElement(a[1])];c.fn.attr.call(a,b,true)}else a=[f.createElement(a[1])];else{a=sa([d[1]],[f]);a=(a.cacheable?a.fragment.cloneNode(true):a.fragment).childNodes}return c.merge(this,a)}else{if(b=s.getElementById(d[2])){if(b.id!==d[2])return T.find(a);this.length=1;this[0]=b}this.context=s;this.selector=a;return this}else if(!b&amp;&amp;/^\w+$/.test(a)){this.selector=a;this.context=s;a=s.getElementsByTagName(a);return c.merge(this,
+a)}else return!b||b.jquery?(b||T).find(a):c(b).find(a);else if(c.isFunction(a))return T.ready(a);if(a.selector!==w){this.selector=a.selector;this.context=a.context}return c.makeArray(a,this)},selector:&quot;&quot;,jquery:&quot;1.4.2&quot;,length:0,size:function(){return this.length},toArray:function(){return R.call(this,0)},get:function(a){return a==null?this.toArray():a&lt;0?this.slice(a)[0]:this[a]},pushStack:function(a,b,d){var f=c();c.isArray(a)?ba.apply(f,a):c.merge(f,a);f.prevObject=this;f.context=this.context;if(b===
+&quot;find&quot;)f.selector=this.selector+(this.selector?&quot; &quot;:&quot;&quot;)+d;else if(b)f.selector=this.selector+&quot;.&quot;+b+&quot;(&quot;+d+&quot;)&quot;;return f},each:function(a,b){return c.each(this,a,b)},ready:function(a){c.bindReady();if(c.isReady)a.call(s,c);else Q&amp;&amp;Q.push(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(R.apply(this,arguments),&quot;slice&quot;,R.call(arguments).join(&quot;,&quot;))},map:function(a){return this.pushStack(c.map(this,
+function(b,d){return a.call(b,d,b)}))},end:function(){return this.prevObject||c(null)},push:ba,sort:[].sort,splice:[].splice};c.fn.init.prototype=c.fn;c.extend=c.fn.extend=function(){var a=arguments[0]||{},b=1,d=arguments.length,f=false,e,j,i,o;if(typeof a===&quot;boolean&quot;){f=a;a=arguments[1]||{};b=2}if(typeof a!==&quot;object&quot;&amp;&amp;!c.isFunction(a))a={};if(d===b){a=this;--b}for(;b&lt;d;b++)if((e=arguments[b])!=null)for(j in e){i=a[j];o=e[j];if(a!==o)if(f&amp;&amp;o&amp;&amp;(c.isPlainObject(o)||c.isArray(o))){i=i&amp;&amp;(c.isPlainObject(i)||
+c.isArray(i))?i:c.isArray(o)?[]:{};a[j]=c.extend(f,i,o)}else if(o!==w)a[j]=o}return a};c.extend({noConflict:function(a){A.$=Sa;if(a)A.jQuery=Ra;return c},isReady:false,ready:function(){if(!c.isReady){if(!s.body)return setTimeout(c.ready,13);c.isReady=true;if(Q){for(var a,b=0;a=Q[b++];)a.call(s,c);Q=null}c.fn.triggerHandler&amp;&amp;c(s).triggerHandler(&quot;ready&quot;)}},bindReady:function(){if(!xa){xa=true;if(s.readyState===&quot;complete&quot;)return c.ready();if(s.addEventListener){s.addEventListener(&quot;DOMContentLoaded&quot;,
+L,false);A.addEventListener(&quot;load&quot;,c.ready,false)}else if(s.attachEvent){s.attachEvent(&quot;onreadystatechange&quot;,L);A.attachEvent(&quot;onload&quot;,c.ready);var a=false;try{a=A.frameElement==null}catch(b){}s.documentElement.doScroll&amp;&amp;a&amp;&amp;ma()}}},isFunction:function(a){return $.call(a)===&quot;[object Function]&quot;},isArray:function(a){return $.call(a)===&quot;[object Array]&quot;},isPlainObject:function(a){if(!a||$.call(a)!==&quot;[object Object]&quot;||a.nodeType||a.setInterval)return false;if(a.constructor&amp;&amp;!aa.call(a,&quot;constructor&quot;)&amp;&amp;!aa.call(a.constructor.prototype,
+&quot;isPrototypeOf&quot;))return false;var b;for(b in a);return b===w||aa.call(a,b)},isEmptyObject:function(a){for(var b in a)return false;return true},error:function(a){throw a;},parseJSON:function(a){if(typeof a!==&quot;string&quot;||!a)return null;a=c.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:[&quot;\\\/bfnrt]|u[0-9a-fA-F]{4})/g,&quot;@&quot;).replace(/&quot;[^&quot;\\\n\r]*&quot;|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,&quot;]&quot;).replace(/(?:^|:|,)(?:\s*\[)+/g,&quot;&quot;)))return A.JSON&amp;&amp;A.JSON.parse?A.JSON.parse(a):(new Function(&quot;return &quot;+
+a))();else c.error(&quot;Invalid JSON: &quot;+a)},noop:function(){},globalEval:function(a){if(a&amp;&amp;Va.test(a)){var b=s.getElementsByTagName(&quot;head&quot;)[0]||s.documentElement,d=s.createElement(&quot;script&quot;);d.type=&quot;text/javascript&quot;;if(c.support.scriptEval)d.appendChild(s.createTextNode(a));else d.text=a;b.insertBefore(d,b.firstChild);b.removeChild(d)}},nodeName:function(a,b){return a.nodeName&amp;&amp;a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,b,d){var f,e=0,j=a.length,i=j===w||c.isFunction(a);if(d)if(i)for(f in a){if(b.apply(a[f],
+d)===false)break}else for(;e&lt;j;){if(b.apply(a[e++],d)===false)break}else if(i)for(f in a){if(b.call(a[f],f,a[f])===false)break}else for(d=a[0];e&lt;j&amp;&amp;b.call(d,e,d)!==false;d=a[++e]);return a},trim:function(a){return(a||&quot;&quot;).replace(Wa,&quot;&quot;)},makeArray:function(a,b){b=b||[];if(a!=null)a.length==null||typeof a===&quot;string&quot;||c.isFunction(a)||typeof a!==&quot;function&quot;&amp;&amp;a.setInterval?ba.call(b,a):c.merge(b,a);return b},inArray:function(a,b){if(b.indexOf)return b.indexOf(a);for(var d=0,f=b.length;d&lt;f;d++)if(b[d]===
+a)return d;return-1},merge:function(a,b){var d=a.length,f=0;if(typeof b.length===&quot;number&quot;)for(var e=b.length;f&lt;e;f++)a[d++]=b[f];else for(;b[f]!==w;)a[d++]=b[f++];a.length=d;return a},grep:function(a,b,d){for(var f=[],e=0,j=a.length;e&lt;j;e++)!d!==!b(a[e],e)&amp;&amp;f.push(a[e]);return f},map:function(a,b,d){for(var f=[],e,j=0,i=a.length;j&lt;i;j++){e=b(a[j],j,d);if(e!=null)f[f.length]=e}return f.concat.apply([],f)},guid:1,proxy:function(a,b,d){if(arguments.length===2)if(typeof b===&quot;string&quot;){d=a;a=d[b];b=w}else if(b&amp;&amp;
+!c.isFunction(b)){d=b;b=w}if(!b&amp;&amp;a)b=function(){return a.apply(d||this,arguments)};if(a)b.guid=a.guid=a.guid||b.guid||c.guid++;return b},uaMatch:function(a){a=a.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&amp;&amp;/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:a[1]||&quot;&quot;,version:a[2]||&quot;0&quot;}},browser:{}});P=c.uaMatch(P);if(P.browser){c.browser[P.browser]=true;c.browser.version=P.version}if(c.browser.webkit)c.browser.safari=
+true;if(ya)c.inArray=function(a,b){return ya.call(b,a)};T=c(s);if(s.addEventListener)L=function(){s.removeEventListener(&quot;DOMContentLoaded&quot;,L,false);c.ready()};else if(s.attachEvent)L=function(){if(s.readyState===&quot;complete&quot;){s.detachEvent(&quot;onreadystatechange&quot;,L);c.ready()}};(function(){c.support={};var a=s.documentElement,b=s.createElement(&quot;script&quot;),d=s.createElement(&quot;div&quot;),f=&quot;script&quot;+J();d.style.display=&quot;none&quot;;d.innerHTML=&quot;   &lt;link/&gt;&lt;table&gt;&lt;/table&gt;&lt;a href='/a' style='color:red;float:left;opacity:.55;'&gt;a&lt;/a&gt;&lt;input type='checkbox'/&gt;&quot;;
+var e=d.getElementsByTagName(&quot;*&quot;),j=d.getElementsByTagName(&quot;a&quot;)[0];if(!(!e||!e.length||!j)){c.support={leadingWhitespace:d.firstChild.nodeType===3,tbody:!d.getElementsByTagName(&quot;tbody&quot;).length,htmlSerialize:!!d.getElementsByTagName(&quot;link&quot;).length,style:/red/.test(j.getAttribute(&quot;style&quot;)),hrefNormalized:j.getAttribute(&quot;href&quot;)===&quot;/a&quot;,opacity:/^0.55$/.test(j.style.opacity),cssFloat:!!j.style.cssFloat,checkOn:d.getElementsByTagName(&quot;input&quot;)[0].value===&quot;on&quot;,optSelected:s.createElement(&quot;select&quot;).appendChild(s.createElement(&quot;option&quot;)).selected,
+parentNode:d.removeChild(d.appendChild(s.createElement(&quot;div&quot;))).parentNode===null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};b.type=&quot;text/javascript&quot;;try{b.appendChild(s.createTextNode(&quot;window.&quot;+f+&quot;=1;&quot;))}catch(i){}a.insertBefore(b,a.firstChild);if(A[f]){c.support.scriptEval=true;delete A[f]}try{delete b.test}catch(o){c.support.deleteExpando=false}a.removeChild(b);if(d.attachEvent&amp;&amp;d.fireEvent){d.attachEvent(&quot;onclick&quot;,function k(){c.support.noCloneEvent=
+false;d.detachEvent(&quot;onclick&quot;,k)});d.cloneNode(true).fireEvent(&quot;onclick&quot;)}d=s.createElement(&quot;div&quot;);d.innerHTML=&quot;&lt;input type='radio' name='radiotest' checked='checked'/&gt;&quot;;a=s.createDocumentFragment();a.appendChild(d.firstChild);c.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;c(function(){var k=s.createElement(&quot;div&quot;);k.style.width=k.style.paddingLeft=&quot;1px&quot;;s.body.appendChild(k);c.boxModel=c.support.boxModel=k.offsetWidth===2;s.body.removeChild(k).style.display=&quot;none&quot;});a=function(k){var n=
+s.createElement(&quot;div&quot;);k=&quot;on&quot;+k;var r=k in n;if(!r){n.setAttribute(k,&quot;return;&quot;);r=typeof n[k]===&quot;function&quot;}return r};c.support.submitBubbles=a(&quot;submit&quot;);c.support.changeBubbles=a(&quot;change&quot;);a=b=d=e=j=null}})();c.props={&quot;for&quot;:&quot;htmlFor&quot;,&quot;class&quot;:&quot;className&quot;,readonly:&quot;readOnly&quot;,maxlength:&quot;maxLength&quot;,cellspacing:&quot;cellSpacing&quot;,rowspan:&quot;rowSpan&quot;,colspan:&quot;colSpan&quot;,tabindex:&quot;tabIndex&quot;,usemap:&quot;useMap&quot;,frameborder:&quot;frameBorder&quot;};var G=&quot;jQuery&quot;+J(),Ya=0,za={};c.extend({cache:{},expando:G,noData:{embed:true,object:true,
+applet:true},data:function(a,b,d){if(!(a.nodeName&amp;&amp;c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var f=a[G],e=c.cache;if(!f&amp;&amp;typeof b===&quot;string&quot;&amp;&amp;d===w)return null;f||(f=++Ya);if(typeof b===&quot;object&quot;){a[G]=f;e[f]=c.extend(true,{},b)}else if(!e[f]){a[G]=f;e[f]={}}a=e[f];if(d!==w)a[b]=d;return typeof b===&quot;string&quot;?a[b]:a}},removeData:function(a,b){if(!(a.nodeName&amp;&amp;c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var d=a[G],f=c.cache,e=f[d];if(b){if(e){delete e[b];c.isEmptyObject(e)&amp;&amp;c.removeData(a)}}else{if(c.support.deleteExpando)delete a[c.expando];
+else a.removeAttribute&amp;&amp;a.removeAttribute(c.expando);delete f[d]}}}});c.fn.extend({data:function(a,b){if(typeof a===&quot;undefined&quot;&amp;&amp;this.length)return c.data(this[0]);else if(typeof a===&quot;object&quot;)return this.each(function(){c.data(this,a)});var d=a.split(&quot;.&quot;);d[1]=d[1]?&quot;.&quot;+d[1]:&quot;&quot;;if(b===w){var f=this.triggerHandler(&quot;getData&quot;+d[1]+&quot;!&quot;,[d[0]]);if(f===w&amp;&amp;this.length)f=c.data(this[0],a);return f===w&amp;&amp;d[1]?this.data(d[0]):f}else return this.trigger(&quot;setData&quot;+d[1]+&quot;!&quot;,[d[0],b]).each(function(){c.data(this,
+a,b)})},removeData:function(a){return this.each(function(){c.removeData(this,a)})}});c.extend({queue:function(a,b,d){if(a){b=(b||&quot;fx&quot;)+&quot;queue&quot;;var f=c.data(a,b);if(!d)return f||[];if(!f||c.isArray(d))f=c.data(a,b,c.makeArray(d));else f.push(d);return f}},dequeue:function(a,b){b=b||&quot;fx&quot;;var d=c.queue(a,b),f=d.shift();if(f===&quot;inprogress&quot;)f=d.shift();if(f){b===&quot;fx&quot;&amp;&amp;d.unshift(&quot;inprogress&quot;);f.call(a,function(){c.dequeue(a,b)})}}});c.fn.extend({queue:function(a,b){if(typeof a!==&quot;string&quot;){b=a;a=&quot;fx&quot;}if(b===
+w)return c.queue(this[0],a);return this.each(function(){var d=c.queue(this,a,b);a===&quot;fx&quot;&amp;&amp;d[0]!==&quot;inprogress&quot;&amp;&amp;c.dequeue(this,a)})},dequeue:function(a){return this.each(function(){c.dequeue(this,a)})},delay:function(a,b){a=c.fx?c.fx.speeds[a]||a:a;b=b||&quot;fx&quot;;return this.queue(b,function(){var d=this;setTimeout(function(){c.dequeue(d,b)},a)})},clearQueue:function(a){return this.queue(a||&quot;fx&quot;,[])}});var Aa=/[\n\t]/g,ca=/\s+/,Za=/\r/g,$a=/href|src|style/,ab=/(button|input)/i,bb=/(button|input|object|select|textarea)/i,
+cb=/^(a|area)$/i,Ba=/radio|checkbox/;c.fn.extend({attr:function(a,b){return X(this,a,b,true,c.attr)},removeAttr:function(a){return this.each(function(){c.attr(this,a,&quot;&quot;);this.nodeType===1&amp;&amp;this.removeAttribute(a)})},addClass:function(a){if(c.isFunction(a))return this.each(function(n){var r=c(this);r.addClass(a.call(this,n,r.attr(&quot;class&quot;)))});if(a&amp;&amp;typeof a===&quot;string&quot;)for(var b=(a||&quot;&quot;).split(ca),d=0,f=this.length;d&lt;f;d++){var e=this[d];if(e.nodeType===1)if(e.className){for(var j=&quot; &quot;+e.className+&quot; &quot;,
+i=e.className,o=0,k=b.length;o&lt;k;o++)if(j.indexOf(&quot; &quot;+b[o]+&quot; &quot;)&lt;0)i+=&quot; &quot;+b[o];e.className=c.trim(i)}else e.className=a}return this},removeClass:function(a){if(c.isFunction(a))return this.each(function(k){var n=c(this);n.removeClass(a.call(this,k,n.attr(&quot;class&quot;)))});if(a&amp;&amp;typeof a===&quot;string&quot;||a===w)for(var b=(a||&quot;&quot;).split(ca),d=0,f=this.length;d&lt;f;d++){var e=this[d];if(e.nodeType===1&amp;&amp;e.className)if(a){for(var j=(&quot; &quot;+e.className+&quot; &quot;).replace(Aa,&quot; &quot;),i=0,o=b.length;i&lt;o;i++)j=j.replace(&quot; &quot;+b[i]+&quot; &quot;,
+&quot; &quot;);e.className=c.trim(j)}else e.className=&quot;&quot;}return this},toggleClass:function(a,b){var d=typeof a,f=typeof b===&quot;boolean&quot;;if(c.isFunction(a))return this.each(function(e){var j=c(this);j.toggleClass(a.call(this,e,j.attr(&quot;class&quot;),b),b)});return this.each(function(){if(d===&quot;string&quot;)for(var e,j=0,i=c(this),o=b,k=a.split(ca);e=k[j++];){o=f?o:!i.hasClass(e);i[o?&quot;addClass&quot;:&quot;removeClass&quot;](e)}else if(d===&quot;undefined&quot;||d===&quot;boolean&quot;){this.className&amp;&amp;c.data(this,&quot;__className__&quot;,this.className);this.className=
+this.className||a===false?&quot;&quot;:c.data(this,&quot;__className__&quot;)||&quot;&quot;}})},hasClass:function(a){a=&quot; &quot;+a+&quot; &quot;;for(var b=0,d=this.length;b&lt;d;b++)if((&quot; &quot;+this[b].className+&quot; &quot;).replace(Aa,&quot; &quot;).indexOf(a)&gt;-1)return true;return false},val:function(a){if(a===w){var b=this[0];if(b){if(c.nodeName(b,&quot;option&quot;))return(b.attributes.value||{}).specified?b.value:b.text;if(c.nodeName(b,&quot;select&quot;)){var d=b.selectedIndex,f=[],e=b.options;b=b.type===&quot;select-one&quot;;if(d&lt;0)return null;var j=b?d:0;for(d=b?d+1:e.length;j&lt;d;j++){var i=
+e[j];if(i.selected){a=c(i).val();if(b)return a;f.push(a)}}return f}if(Ba.test(b.type)&amp;&amp;!c.support.checkOn)return b.getAttribute(&quot;value&quot;)===null?&quot;on&quot;:b.value;return(b.value||&quot;&quot;).replace(Za,&quot;&quot;)}return w}var o=c.isFunction(a);return this.each(function(k){var n=c(this),r=a;if(this.nodeType===1){if(o)r=a.call(this,k,n.val());if(typeof r===&quot;number&quot;)r+=&quot;&quot;;if(c.isArray(r)&amp;&amp;Ba.test(this.type))this.checked=c.inArray(n.val(),r)&gt;=0;else if(c.nodeName(this,&quot;select&quot;)){var u=c.makeArray(r);c(&quot;option&quot;,this).each(function(){this.selected=
+c.inArray(c(this).val(),u)&gt;=0});if(!u.length)this.selectedIndex=-1}else this.value=r}})}});c.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(a,b,d,f){if(!a||a.nodeType===3||a.nodeType===8)return w;if(f&amp;&amp;b in c.attrFn)return c(a)[b](d);f=a.nodeType!==1||!c.isXMLDoc(a);var e=d!==w;b=f&amp;&amp;c.props[b]||b;if(a.nodeType===1){var j=$a.test(b);if(b in a&amp;&amp;f&amp;&amp;!j){if(e){b===&quot;type&quot;&amp;&amp;ab.test(a.nodeName)&amp;&amp;a.parentNode&amp;&amp;c.error(&quot;type property can't be changed&quot;);
+a[b]=d}if(c.nodeName(a,&quot;form&quot;)&amp;&amp;a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue;if(b===&quot;tabIndex&quot;)return(b=a.getAttributeNode(&quot;tabIndex&quot;))&amp;&amp;b.specified?b.value:bb.test(a.nodeName)||cb.test(a.nodeName)&amp;&amp;a.href?0:w;return a[b]}if(!c.support.style&amp;&amp;f&amp;&amp;b===&quot;style&quot;){if(e)a.style.cssText=&quot;&quot;+d;return a.style.cssText}e&amp;&amp;a.setAttribute(b,&quot;&quot;+d);a=!c.support.hrefNormalized&amp;&amp;f&amp;&amp;j?a.getAttribute(b,2):a.getAttribute(b);return a===null?w:a}return c.style(a,b,d)}});var O=/\.(.*)$/,db=function(a){return a.replace(/[^\w\s\.\|`]/g,
+function(b){return&quot;\\&quot;+b})};c.event={add:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){if(a.setInterval&amp;&amp;a!==A&amp;&amp;!a.frameElement)a=A;var e,j;if(d.handler){e=d;d=e.handler}if(!d.guid)d.guid=c.guid++;if(j=c.data(a)){var i=j.events=j.events||{},o=j.handle;if(!o)j.handle=o=function(){return typeof c!==&quot;undefined&quot;&amp;&amp;!c.event.triggered?c.event.handle.apply(o.elem,arguments):w};o.elem=a;b=b.split(&quot; &quot;);for(var k,n=0,r;k=b[n++];){j=e?c.extend({},e):{handler:d,data:f};if(k.indexOf(&quot;.&quot;)&gt;-1){r=k.split(&quot;.&quot;);
+k=r.shift();j.namespace=r.slice(0).sort().join(&quot;.&quot;)}else{r=[];j.namespace=&quot;&quot;}j.type=k;j.guid=d.guid;var u=i[k],z=c.event.special[k]||{};if(!u){u=i[k]=[];if(!z.setup||z.setup.call(a,f,r,o)===false)if(a.addEventListener)a.addEventListener(k,o,false);else a.attachEvent&amp;&amp;a.attachEvent(&quot;on&quot;+k,o)}if(z.add){z.add.call(a,j);if(!j.handler.guid)j.handler.guid=d.guid}u.push(j);c.event.global[k]=true}a=null}}},global:{},remove:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){var e,j=0,i,o,k,n,r,u,z=c.data(a),
+C=z&amp;&amp;z.events;if(z&amp;&amp;C){if(b&amp;&amp;b.type){d=b.handler;b=b.type}if(!b||typeof b===&quot;string&quot;&amp;&amp;b.charAt(0)===&quot;.&quot;){b=b||&quot;&quot;;for(e in C)c.event.remove(a,e+b)}else{for(b=b.split(&quot; &quot;);e=b[j++];){n=e;i=e.indexOf(&quot;.&quot;)&lt;0;o=[];if(!i){o=e.split(&quot;.&quot;);e=o.shift();k=new RegExp(&quot;(^|\\.)&quot;+c.map(o.slice(0).sort(),db).join(&quot;\\.(?:.*\\.)?&quot;)+&quot;(\\.|$)&quot;)}if(r=C[e])if(d){n=c.event.special[e]||{};for(B=f||0;B&lt;r.length;B++){u=r[B];if(d.guid===u.guid){if(i||k.test(u.namespace)){f==null&amp;&amp;r.splice(B--,1);n.remove&amp;&amp;n.remove.call(a,u)}if(f!=
+null)break}}if(r.length===0||f!=null&amp;&amp;r.length===1){if(!n.teardown||n.teardown.call(a,o)===false)Ca(a,e,z.handle);delete C[e]}}else for(var B=0;B&lt;r.length;B++){u=r[B];if(i||k.test(u.namespace)){c.event.remove(a,n,u.handler,B);r.splice(B--,1)}}}if(c.isEmptyObject(C)){if(b=z.handle)b.elem=null;delete z.events;delete z.handle;c.isEmptyObject(z)&amp;&amp;c.removeData(a)}}}}},trigger:function(a,b,d,f){var e=a.type||a;if(!f){a=typeof a===&quot;object&quot;?a[G]?a:c.extend(c.Event(e),a):c.Event(e);if(e.indexOf(&quot;!&quot;)&gt;=0){a.type=
+e=e.slice(0,-1);a.exclusive=true}if(!d){a.stopPropagation();c.event.global[e]&amp;&amp;c.each(c.cache,function(){this.events&amp;&amp;this.events[e]&amp;&amp;c.event.trigger(a,b,this.handle.elem)})}if(!d||d.nodeType===3||d.nodeType===8)return w;a.result=w;a.target=d;b=c.makeArray(b);b.unshift(a)}a.currentTarget=d;(f=c.data(d,&quot;handle&quot;))&amp;&amp;f.apply(d,b);f=d.parentNode||d.ownerDocument;try{if(!(d&amp;&amp;d.nodeName&amp;&amp;c.noData[d.nodeName.toLowerCase()]))if(d[&quot;on&quot;+e]&amp;&amp;d[&quot;on&quot;+e].apply(d,b)===false)a.result=false}catch(j){}if(!a.isPropagationStopped()&amp;&amp;
+f)c.event.trigger(a,b,f,true);else if(!a.isDefaultPrevented()){f=a.target;var i,o=c.nodeName(f,&quot;a&quot;)&amp;&amp;e===&quot;click&quot;,k=c.event.special[e]||{};if((!k._default||k._default.call(d,a)===false)&amp;&amp;!o&amp;&amp;!(f&amp;&amp;f.nodeName&amp;&amp;c.noData[f.nodeName.toLowerCase()])){try{if(f[e]){if(i=f[&quot;on&quot;+e])f[&quot;on&quot;+e]=null;c.event.triggered=true;f[e]()}}catch(n){}if(i)f[&quot;on&quot;+e]=i;c.event.triggered=false}}},handle:function(a){var b,d,f,e;a=arguments[0]=c.event.fix(a||A.event);a.currentTarget=this;b=a.type.indexOf(&quot;.&quot;)&lt;0&amp;&amp;!a.exclusive;
+if(!b){d=a.type.split(&quot;.&quot;);a.type=d.shift();f=new RegExp(&quot;(^|\\.)&quot;+d.slice(0).sort().join(&quot;\\.(?:.*\\.)?&quot;)+&quot;(\\.|$)&quot;)}e=c.data(this,&quot;events&quot;);d=e[a.type];if(e&amp;&amp;d){d=d.slice(0);e=0;for(var j=d.length;e&lt;j;e++){var i=d[e];if(b||f.test(i.namespace)){a.handler=i.handler;a.data=i.data;a.handleObj=i;i=i.handler.apply(this,arguments);if(i!==w){a.result=i;if(i===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}}return a.result},props:&quot;altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which&quot;.split(&quot; &quot;),
+fix:function(a){if(a[G])return a;var b=a;a=c.Event(b);for(var d=this.props.length,f;d;){f=this.props[--d];a[f]=b[f]}if(!a.target)a.target=a.srcElement||s;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&amp;&amp;a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&amp;&amp;a.clientX!=null){b=s.documentElement;d=s.body;a.pageX=a.clientX+(b&amp;&amp;b.scrollLeft||d&amp;&amp;d.scrollLeft||0)-(b&amp;&amp;b.clientLeft||d&amp;&amp;d.clientLeft||0);a.pageY=a.clientY+(b&amp;&amp;b.scrollTop||
+d&amp;&amp;d.scrollTop||0)-(b&amp;&amp;b.clientTop||d&amp;&amp;d.clientTop||0)}if(!a.which&amp;&amp;(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&amp;&amp;a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&amp;&amp;a.button!==w)a.which=a.button&amp;1?1:a.button&amp;2?3:a.button&amp;4?2:0;return a},guid:1E8,proxy:c.proxy,special:{ready:{setup:c.bindReady,teardown:c.noop},live:{add:function(a){c.event.add(this,a.origType,c.extend({},a,{handler:oa}))},remove:function(a){var b=true,d=a.origType.replace(O,&quot;&quot;);c.each(c.data(this,
+&quot;events&quot;).live||[],function(){if(d===this.origType.replace(O,&quot;&quot;))return b=false});b&amp;&amp;c.event.remove(this,a.origType,oa)}},beforeunload:{setup:function(a,b,d){if(this.setInterval)this.onbeforeunload=d;return false},teardown:function(a,b){if(this.onbeforeunload===b)this.onbeforeunload=null}}}};var Ca=s.removeEventListener?function(a,b,d){a.removeEventListener(b,d,false)}:function(a,b,d){a.detachEvent(&quot;on&quot;+b,d)};c.Event=function(a){if(!this.preventDefault)return new c.Event(a);if(a&amp;&amp;a.type){this.originalEvent=
+a;this.type=a.type}else this.type=a;this.timeStamp=J();this[G]=true};c.Event.prototype={preventDefault:function(){this.isDefaultPrevented=Z;var a=this.originalEvent;if(a){a.preventDefault&amp;&amp;a.preventDefault();a.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=Z;var a=this.originalEvent;if(a){a.stopPropagation&amp;&amp;a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Z;this.stopPropagation()},isDefaultPrevented:Y,isPropagationStopped:Y,
+isImmediatePropagationStopped:Y};var Da=function(a){var b=a.relatedTarget;try{for(;b&amp;&amp;b!==this;)b=b.parentNode;if(b!==this){a.type=a.data;c.event.handle.apply(this,arguments)}}catch(d){}},Ea=function(a){a.type=a.data;c.event.handle.apply(this,arguments)};c.each({mouseenter:&quot;mouseover&quot;,mouseleave:&quot;mouseout&quot;},function(a,b){c.event.special[a]={setup:function(d){c.event.add(this,b,d&amp;&amp;d.selector?Ea:Da,a)},teardown:function(d){c.event.remove(this,b,d&amp;&amp;d.selector?Ea:Da)}}});if(!c.support.submitBubbles)c.event.special.submit=
+{setup:function(){if(this.nodeName.toLowerCase()!==&quot;form&quot;){c.event.add(this,&quot;click.specialSubmit&quot;,function(a){var b=a.target,d=b.type;if((d===&quot;submit&quot;||d===&quot;image&quot;)&amp;&amp;c(b).closest(&quot;form&quot;).length)return na(&quot;submit&quot;,this,arguments)});c.event.add(this,&quot;keypress.specialSubmit&quot;,function(a){var b=a.target,d=b.type;if((d===&quot;text&quot;||d===&quot;password&quot;)&amp;&amp;c(b).closest(&quot;form&quot;).length&amp;&amp;a.keyCode===13)return na(&quot;submit&quot;,this,arguments)})}else return false},teardown:function(){c.event.remove(this,&quot;.specialSubmit&quot;)}};
+if(!c.support.changeBubbles){var da=/textarea|input|select/i,ea,Fa=function(a){var b=a.type,d=a.value;if(b===&quot;radio&quot;||b===&quot;checkbox&quot;)d=a.checked;else if(b===&quot;select-multiple&quot;)d=a.selectedIndex&gt;-1?c.map(a.options,function(f){return f.selected}).join(&quot;-&quot;):&quot;&quot;;else if(a.nodeName.toLowerCase()===&quot;select&quot;)d=a.selectedIndex;return d},fa=function(a,b){var d=a.target,f,e;if(!(!da.test(d.nodeName)||d.readOnly)){f=c.data(d,&quot;_change_data&quot;);e=Fa(d);if(a.type!==&quot;focusout&quot;||d.type!==&quot;radio&quot;)c.data(d,&quot;_change_data&quot;,
+e);if(!(f===w||e===f))if(f!=null||e){a.type=&quot;change&quot;;return c.event.trigger(a,b,d)}}};c.event.special.change={filters:{focusout:fa,click:function(a){var b=a.target,d=b.type;if(d===&quot;radio&quot;||d===&quot;checkbox&quot;||b.nodeName.toLowerCase()===&quot;select&quot;)return fa.call(this,a)},keydown:function(a){var b=a.target,d=b.type;if(a.keyCode===13&amp;&amp;b.nodeName.toLowerCase()!==&quot;textarea&quot;||a.keyCode===32&amp;&amp;(d===&quot;checkbox&quot;||d===&quot;radio&quot;)||d===&quot;select-multiple&quot;)return fa.call(this,a)},beforeactivate:function(a){a=a.target;c.data(a,
+&quot;_change_data&quot;,Fa(a))}},setup:function(){if(this.type===&quot;file&quot;)return false;for(var a in ea)c.event.add(this,a+&quot;.specialChange&quot;,ea[a]);return da.test(this.nodeName)},teardown:function(){c.event.remove(this,&quot;.specialChange&quot;);return da.test(this.nodeName)}};ea=c.event.special.change.filters}s.addEventListener&amp;&amp;c.each({focus:&quot;focusin&quot;,blur:&quot;focusout&quot;},function(a,b){function d(f){f=c.event.fix(f);f.type=b;return c.event.handle.call(this,f)}c.event.special[b]={setup:function(){this.addEventListener(a,
+d,true)},teardown:function(){this.removeEventListener(a,d,true)}}});c.each([&quot;bind&quot;,&quot;one&quot;],function(a,b){c.fn[b]=function(d,f,e){if(typeof d===&quot;object&quot;){for(var j in d)this[b](j,f,d[j],e);return this}if(c.isFunction(f)){e=f;f=w}var i=b===&quot;one&quot;?c.proxy(e,function(k){c(this).unbind(k,i);return e.apply(this,arguments)}):e;if(d===&quot;unload&quot;&amp;&amp;b!==&quot;one&quot;)this.one(d,f,e);else{j=0;for(var o=this.length;j&lt;o;j++)c.event.add(this[j],d,i,f)}return this}});c.fn.extend({unbind:function(a,b){if(typeof a===&quot;object&quot;&amp;&amp;
+!a.preventDefault)for(var d in a)this.unbind(d,a[d]);else{d=0;for(var f=this.length;d&lt;f;d++)c.event.remove(this[d],a,b)}return this},delegate:function(a,b,d,f){return this.live(b,d,f,a)},undelegate:function(a,b,d){return arguments.length===0?this.unbind(&quot;live&quot;):this.die(b,null,d,a)},trigger:function(a,b){return this.each(function(){c.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){a=c.Event(a);a.preventDefault();a.stopPropagation();c.event.trigger(a,b,this[0]);return a.result}},
+toggle:function(a){for(var b=arguments,d=1;d&lt;b.length;)c.proxy(a,b[d++]);return this.click(c.proxy(a,function(f){var e=(c.data(this,&quot;lastToggle&quot;+a.guid)||0)%d;c.data(this,&quot;lastToggle&quot;+a.guid,e+1);f.preventDefault();return b[e].apply(this,arguments)||false}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Ga={focus:&quot;focusin&quot;,blur:&quot;focusout&quot;,mouseenter:&quot;mouseover&quot;,mouseleave:&quot;mouseout&quot;};c.each([&quot;live&quot;,&quot;die&quot;],function(a,b){c.fn[b]=function(d,f,e,j){var i,o=0,k,n,r=j||this.selector,
+u=j?this:c(this.context);if(c.isFunction(f)){e=f;f=w}for(d=(d||&quot;&quot;).split(&quot; &quot;);(i=d[o++])!=null;){j=O.exec(i);k=&quot;&quot;;if(j){k=j[0];i=i.replace(O,&quot;&quot;)}if(i===&quot;hover&quot;)d.push(&quot;mouseenter&quot;+k,&quot;mouseleave&quot;+k);else{n=i;if(i===&quot;focus&quot;||i===&quot;blur&quot;){d.push(Ga[i]+k);i+=k}else i=(Ga[i]||i)+k;b===&quot;live&quot;?u.each(function(){c.event.add(this,pa(i,r),{data:f,selector:r,handler:e,origType:i,origHandler:e,preType:n})}):u.unbind(pa(i,r),e)}}return this}});c.each(&quot;blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error&quot;.split(&quot; &quot;),
+function(a,b){c.fn[b]=function(d){return d?this.bind(b,d):this.trigger(b)};if(c.attrFn)c.attrFn[b]=true});A.attachEvent&amp;&amp;!A.addEventListener&amp;&amp;A.attachEvent(&quot;onunload&quot;,function(){for(var a in c.cache)if(c.cache[a].handle)try{c.event.remove(c.cache[a].handle.elem)}catch(b){}});(function(){function a(g){for(var h=&quot;&quot;,l,m=0;g[m];m++){l=g[m];if(l.nodeType===3||l.nodeType===4)h+=l.nodeValue;else if(l.nodeType!==8)h+=a(l.childNodes)}return h}function b(g,h,l,m,q,p){q=0;for(var v=m.length;q&lt;v;q++){var t=m[q];
+if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break}if(t.nodeType===1&amp;&amp;!p){t.sizcache=l;t.sizset=q}if(t.nodeName.toLowerCase()===h){y=t;break}t=t[g]}m[q]=y}}}function d(g,h,l,m,q,p){q=0;for(var v=m.length;q&lt;v;q++){var t=m[q];if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break}if(t.nodeType===1){if(!p){t.sizcache=l;t.sizset=q}if(typeof h!==&quot;string&quot;){if(t===h){y=true;break}}else if(k.filter(h,[t]).length&gt;0){y=t;break}}t=t[g]}m[q]=y}}}var f=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['&quot;][^'&quot;]*['&quot;]|[^[\]'&quot;]+)+\]|\\.|[^ &gt;+~,(\[\\]+)+|[&gt;+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
+e=0,j=Object.prototype.toString,i=false,o=true;[0,0].sort(function(){o=false;return 0});var k=function(g,h,l,m){l=l||[];var q=h=h||s;if(h.nodeType!==1&amp;&amp;h.nodeType!==9)return[];if(!g||typeof g!==&quot;string&quot;)return l;for(var p=[],v,t,y,S,H=true,M=x(h),I=g;(f.exec(&quot;&quot;),v=f.exec(I))!==null;){I=v[3];p.push(v[1]);if(v[2]){S=v[3];break}}if(p.length&gt;1&amp;&amp;r.exec(g))if(p.length===2&amp;&amp;n.relative[p[0]])t=ga(p[0]+p[1],h);else for(t=n.relative[p[0]]?[h]:k(p.shift(),h);p.length;){g=p.shift();if(n.relative[g])g+=p.shift();
+t=ga(g,t)}else{if(!m&amp;&amp;p.length&gt;1&amp;&amp;h.nodeType===9&amp;&amp;!M&amp;&amp;n.match.ID.test(p[0])&amp;&amp;!n.match.ID.test(p[p.length-1])){v=k.find(p.shift(),h,M);h=v.expr?k.filter(v.expr,v.set)[0]:v.set[0]}if(h){v=m?{expr:p.pop(),set:z(m)}:k.find(p.pop(),p.length===1&amp;&amp;(p[0]===&quot;~&quot;||p[0]===&quot;+&quot;)&amp;&amp;h.parentNode?h.parentNode:h,M);t=v.expr?k.filter(v.expr,v.set):v.set;if(p.length&gt;0)y=z(t);else H=false;for(;p.length;){var D=p.pop();v=D;if(n.relative[D])v=p.pop();else D=&quot;&quot;;if(v==null)v=h;n.relative[D](y,v,M)}}else y=[]}y||(y=t);y||k.error(D||
+g);if(j.call(y)===&quot;[object Array]&quot;)if(H)if(h&amp;&amp;h.nodeType===1)for(g=0;y[g]!=null;g++){if(y[g]&amp;&amp;(y[g]===true||y[g].nodeType===1&amp;&amp;E(h,y[g])))l.push(t[g])}else for(g=0;y[g]!=null;g++)y[g]&amp;&amp;y[g].nodeType===1&amp;&amp;l.push(t[g]);else l.push.apply(l,y);else z(y,l);if(S){k(S,q,l,m);k.uniqueSort(l)}return l};k.uniqueSort=function(g){if(B){i=o;g.sort(B);if(i)for(var h=1;h&lt;g.length;h++)g[h]===g[h-1]&amp;&amp;g.splice(h--,1)}return g};k.matches=function(g,h){return k(g,null,null,h)};k.find=function(g,h,l){var m,q;if(!g)return[];
+for(var p=0,v=n.order.length;p&lt;v;p++){var t=n.order[p];if(q=n.leftMatch[t].exec(g)){var y=q[1];q.splice(1,1);if(y.substr(y.length-1)!==&quot;\\&quot;){q[1]=(q[1]||&quot;&quot;).replace(/\\/g,&quot;&quot;);m=n.find[t](q,h,l);if(m!=null){g=g.replace(n.match[t],&quot;&quot;);break}}}}m||(m=h.getElementsByTagName(&quot;*&quot;));return{set:m,expr:g}};k.filter=function(g,h,l,m){for(var q=g,p=[],v=h,t,y,S=h&amp;&amp;h[0]&amp;&amp;x(h[0]);g&amp;&amp;h.length;){for(var H in n.filter)if((t=n.leftMatch[H].exec(g))!=null&amp;&amp;t[2]){var M=n.filter[H],I,D;D=t[1];y=false;t.splice(1,1);if(D.substr(D.length-
+1)!==&quot;\\&quot;){if(v===p)p=[];if(n.preFilter[H])if(t=n.preFilter[H](t,v,l,p,m,S)){if(t===true)continue}else y=I=true;if(t)for(var U=0;(D=v[U])!=null;U++)if(D){I=M(D,t,U,v);var Ha=m^!!I;if(l&amp;&amp;I!=null)if(Ha)y=true;else v[U]=false;else if(Ha){p.push(D);y=true}}if(I!==w){l||(v=p);g=g.replace(n.match[H],&quot;&quot;);if(!y)return[];break}}}if(g===q)if(y==null)k.error(g);else break;q=g}return v};k.error=function(g){throw&quot;Syntax error, unrecognized expression: &quot;+g;};var n=k.selectors={order:[&quot;ID&quot;,&quot;NAME&quot;,&quot;TAG&quot;],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,
+CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['&quot;]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['&quot;]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['&quot;]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['&quot;]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{&quot;class&quot;:&quot;className&quot;,&quot;for&quot;:&quot;htmlFor&quot;},attrHandle:{href:function(g){return g.getAttribute(&quot;href&quot;)}},
+relative:{&quot;+&quot;:function(g,h){var l=typeof h===&quot;string&quot;,m=l&amp;&amp;!/\W/.test(h);l=l&amp;&amp;!m;if(m)h=h.toLowerCase();m=0;for(var q=g.length,p;m&lt;q;m++)if(p=g[m]){for(;(p=p.previousSibling)&amp;&amp;p.nodeType!==1;);g[m]=l||p&amp;&amp;p.nodeName.toLowerCase()===h?p||false:p===h}l&amp;&amp;k.filter(h,g,true)},&quot;&gt;&quot;:function(g,h){var l=typeof h===&quot;string&quot;;if(l&amp;&amp;!/\W/.test(h)){h=h.toLowerCase();for(var m=0,q=g.length;m&lt;q;m++){var p=g[m];if(p){l=p.parentNode;g[m]=l.nodeName.toLowerCase()===h?l:false}}}else{m=0;for(q=g.length;m&lt;q;m++)if(p=g[m])g[m]=
+l?p.parentNode:p.parentNode===h;l&amp;&amp;k.filter(h,g,true)}},&quot;&quot;:function(g,h,l){var m=e++,q=d;if(typeof h===&quot;string&quot;&amp;&amp;!/\W/.test(h)){var p=h=h.toLowerCase();q=b}q(&quot;parentNode&quot;,h,m,g,p,l)},&quot;~&quot;:function(g,h,l){var m=e++,q=d;if(typeof h===&quot;string&quot;&amp;&amp;!/\W/.test(h)){var p=h=h.toLowerCase();q=b}q(&quot;previousSibling&quot;,h,m,g,p,l)}},find:{ID:function(g,h,l){if(typeof h.getElementById!==&quot;undefined&quot;&amp;&amp;!l)return(g=h.getElementById(g[1]))?[g]:[]},NAME:function(g,h){if(typeof h.getElementsByName!==&quot;undefined&quot;){var l=[];
+h=h.getElementsByName(g[1]);for(var m=0,q=h.length;m&lt;q;m++)h[m].getAttribute(&quot;name&quot;)===g[1]&amp;&amp;l.push(h[m]);return l.length===0?null:l}},TAG:function(g,h){return h.getElementsByTagName(g[1])}},preFilter:{CLASS:function(g,h,l,m,q,p){g=&quot; &quot;+g[1].replace(/\\/g,&quot;&quot;)+&quot; &quot;;if(p)return g;p=0;for(var v;(v=h[p])!=null;p++)if(v)if(q^(v.className&amp;&amp;(&quot; &quot;+v.className+&quot; &quot;).replace(/[\t\n]/g,&quot; &quot;).indexOf(g)&gt;=0))l||m.push(v);else if(l)h[p]=false;return false},ID:function(g){return g[1].replace(/\\/g,&quot;&quot;)},TAG:function(g){return g[1].toLowerCase()},
+CHILD:function(g){if(g[1]===&quot;nth&quot;){var h=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(g[2]===&quot;even&quot;&amp;&amp;&quot;2n&quot;||g[2]===&quot;odd&quot;&amp;&amp;&quot;2n+1&quot;||!/\D/.test(g[2])&amp;&amp;&quot;0n+&quot;+g[2]||g[2]);g[2]=h[1]+(h[2]||1)-0;g[3]=h[3]-0}g[0]=e++;return g},ATTR:function(g,h,l,m,q,p){h=g[1].replace(/\\/g,&quot;&quot;);if(!p&amp;&amp;n.attrMap[h])g[1]=n.attrMap[h];if(g[2]===&quot;~=&quot;)g[4]=&quot; &quot;+g[4]+&quot; &quot;;return g},PSEUDO:function(g,h,l,m,q){if(g[1]===&quot;not&quot;)if((f.exec(g[3])||&quot;&quot;).length&gt;1||/^\w/.test(g[3]))g[3]=k(g[3],null,null,h);else{g=k.filter(g[3],h,l,true^q);l||m.push.apply(m,
+g);return false}else if(n.match.POS.test(g[0])||n.match.CHILD.test(g[0]))return true;return g},POS:function(g){g.unshift(true);return g}},filters:{enabled:function(g){return g.disabled===false&amp;&amp;g.type!==&quot;hidden&quot;},disabled:function(g){return g.disabled===true},checked:function(g){return g.checked===true},selected:function(g){return g.selected===true},parent:function(g){return!!g.firstChild},empty:function(g){return!g.firstChild},has:function(g,h,l){return!!k(l[3],g).length},header:function(g){return/h\d/i.test(g.nodeName)},
+text:function(g){return&quot;text&quot;===g.type},radio:function(g){return&quot;radio&quot;===g.type},checkbox:function(g){return&quot;checkbox&quot;===g.type},file:function(g){return&quot;file&quot;===g.type},password:function(g){return&quot;password&quot;===g.type},submit:function(g){return&quot;submit&quot;===g.type},image:function(g){return&quot;image&quot;===g.type},reset:function(g){return&quot;reset&quot;===g.type},button:function(g){return&quot;button&quot;===g.type||g.nodeName.toLowerCase()===&quot;button&quot;},input:function(g){return/input|select|textarea|button/i.test(g.nodeName)}},
+setFilters:{first:function(g,h){return h===0},last:function(g,h,l,m){return h===m.length-1},even:function(g,h){return h%2===0},odd:function(g,h){return h%2===1},lt:function(g,h,l){return h&lt;l[3]-0},gt:function(g,h,l){return h&gt;l[3]-0},nth:function(g,h,l){return l[3]-0===h},eq:function(g,h,l){return l[3]-0===h}},filter:{PSEUDO:function(g,h,l,m){var q=h[1],p=n.filters[q];if(p)return p(g,l,h,m);else if(q===&quot;contains&quot;)return(g.textContent||g.innerText||a([g])||&quot;&quot;).indexOf(h[3])&gt;=0;else if(q===&quot;not&quot;){h=
+h[3];l=0;for(m=h.length;l&lt;m;l++)if(h[l]===g)return false;return true}else k.error(&quot;Syntax error, unrecognized expression: &quot;+q)},CHILD:function(g,h){var l=h[1],m=g;switch(l){case &quot;only&quot;:case &quot;first&quot;:for(;m=m.previousSibling;)if(m.nodeType===1)return false;if(l===&quot;first&quot;)return true;m=g;case &quot;last&quot;:for(;m=m.nextSibling;)if(m.nodeType===1)return false;return true;case &quot;nth&quot;:l=h[2];var q=h[3];if(l===1&amp;&amp;q===0)return true;h=h[0];var p=g.parentNode;if(p&amp;&amp;(p.sizcache!==h||!g.nodeIndex)){var v=0;for(m=p.firstChild;m;m=
+m.nextSibling)if(m.nodeType===1)m.nodeIndex=++v;p.sizcache=h}g=g.nodeIndex-q;return l===0?g===0:g%l===0&amp;&amp;g/l&gt;=0}},ID:function(g,h){return g.nodeType===1&amp;&amp;g.getAttribute(&quot;id&quot;)===h},TAG:function(g,h){return h===&quot;*&quot;&amp;&amp;g.nodeType===1||g.nodeName.toLowerCase()===h},CLASS:function(g,h){return(&quot; &quot;+(g.className||g.getAttribute(&quot;class&quot;))+&quot; &quot;).indexOf(h)&gt;-1},ATTR:function(g,h){var l=h[1];g=n.attrHandle[l]?n.attrHandle[l](g):g[l]!=null?g[l]:g.getAttribute(l);l=g+&quot;&quot;;var m=h[2];h=h[4];return g==null?m===&quot;!=&quot;:m===
+&quot;=&quot;?l===h:m===&quot;*=&quot;?l.indexOf(h)&gt;=0:m===&quot;~=&quot;?(&quot; &quot;+l+&quot; &quot;).indexOf(h)&gt;=0:!h?l&amp;&amp;g!==false:m===&quot;!=&quot;?l!==h:m===&quot;^=&quot;?l.indexOf(h)===0:m===&quot;$=&quot;?l.substr(l.length-h.length)===h:m===&quot;|=&quot;?l===h||l.substr(0,h.length+1)===h+&quot;-&quot;:false},POS:function(g,h,l,m){var q=n.setFilters[h[2]];if(q)return q(g,l,h,m)}}},r=n.match.POS;for(var u in n.match){n.match[u]=new RegExp(n.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[u]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[u].source.replace(/\\(\d+)/g,function(g,
+h){return&quot;\\&quot;+(h-0+1)}))}var z=function(g,h){g=Array.prototype.slice.call(g,0);if(h){h.push.apply(h,g);return h}return g};try{Array.prototype.slice.call(s.documentElement.childNodes,0)}catch(C){z=function(g,h){h=h||[];if(j.call(g)===&quot;[object Array]&quot;)Array.prototype.push.apply(h,g);else if(typeof g.length===&quot;number&quot;)for(var l=0,m=g.length;l&lt;m;l++)h.push(g[l]);else for(l=0;g[l];l++)h.push(g[l]);return h}}var B;if(s.documentElement.compareDocumentPosition)B=function(g,h){if(!g.compareDocumentPosition||
+!h.compareDocumentPosition){if(g==h)i=true;return g.compareDocumentPosition?-1:1}g=g.compareDocumentPosition(h)&amp;4?-1:g===h?0:1;if(g===0)i=true;return g};else if(&quot;sourceIndex&quot;in s.documentElement)B=function(g,h){if(!g.sourceIndex||!h.sourceIndex){if(g==h)i=true;return g.sourceIndex?-1:1}g=g.sourceIndex-h.sourceIndex;if(g===0)i=true;return g};else if(s.createRange)B=function(g,h){if(!g.ownerDocument||!h.ownerDocument){if(g==h)i=true;return g.ownerDocument?-1:1}var l=g.ownerDocument.createRange(),m=
+h.ownerDocument.createRange();l.setStart(g,0);l.setEnd(g,0);m.setStart(h,0);m.setEnd(h,0);g=l.compareBoundaryPoints(Range.START_TO_END,m);if(g===0)i=true;return g};(function(){var g=s.createElement(&quot;div&quot;),h=&quot;script&quot;+(new Date).getTime();g.innerHTML=&quot;&lt;a name='&quot;+h+&quot;'/&gt;&quot;;var l=s.documentElement;l.insertBefore(g,l.firstChild);if(s.getElementById(h)){n.find.ID=function(m,q,p){if(typeof q.getElementById!==&quot;undefined&quot;&amp;&amp;!p)return(q=q.getElementById(m[1]))?q.id===m[1]||typeof q.getAttributeNode!==&quot;undefined&quot;&amp;&amp;
+q.getAttributeNode(&quot;id&quot;).nodeValue===m[1]?[q]:w:[]};n.filter.ID=function(m,q){var p=typeof m.getAttributeNode!==&quot;undefined&quot;&amp;&amp;m.getAttributeNode(&quot;id&quot;);return m.nodeType===1&amp;&amp;p&amp;&amp;p.nodeValue===q}}l.removeChild(g);l=g=null})();(function(){var g=s.createElement(&quot;div&quot;);g.appendChild(s.createComment(&quot;&quot;));if(g.getElementsByTagName(&quot;*&quot;).length&gt;0)n.find.TAG=function(h,l){l=l.getElementsByTagName(h[1]);if(h[1]===&quot;*&quot;){h=[];for(var m=0;l[m];m++)l[m].nodeType===1&amp;&amp;h.push(l[m]);l=h}return l};g.innerHTML=&quot;&lt;a href='#'&gt;&lt;/a&gt;&quot;;
+if(g.firstChild&amp;&amp;typeof g.firstChild.getAttribute!==&quot;undefined&quot;&amp;&amp;g.firstChild.getAttribute(&quot;href&quot;)!==&quot;#&quot;)n.attrHandle.href=function(h){return h.getAttribute(&quot;href&quot;,2)};g=null})();s.querySelectorAll&amp;&amp;function(){var g=k,h=s.createElement(&quot;div&quot;);h.innerHTML=&quot;&lt;p class='TEST'&gt;&lt;/p&gt;&quot;;if(!(h.querySelectorAll&amp;&amp;h.querySelectorAll(&quot;.TEST&quot;).length===0)){k=function(m,q,p,v){q=q||s;if(!v&amp;&amp;q.nodeType===9&amp;&amp;!x(q))try{return z(q.querySelectorAll(m),p)}catch(t){}return g(m,q,p,v)};for(var l in g)k[l]=g[l];h=null}}();
+(function(){var g=s.createElement(&quot;div&quot;);g.innerHTML=&quot;&lt;div class='test e'&gt;&lt;/div&gt;&lt;div class='test'&gt;&lt;/div&gt;&quot;;if(!(!g.getElementsByClassName||g.getElementsByClassName(&quot;e&quot;).length===0)){g.lastChild.className=&quot;e&quot;;if(g.getElementsByClassName(&quot;e&quot;).length!==1){n.order.splice(1,0,&quot;CLASS&quot;);n.find.CLASS=function(h,l,m){if(typeof l.getElementsByClassName!==&quot;undefined&quot;&amp;&amp;!m)return l.getElementsByClassName(h[1])};g=null}}})();var E=s.compareDocumentPosition?function(g,h){return!!(g.compareDocumentPosition(h)&amp;16)}:
+function(g,h){return g!==h&amp;&amp;(g.contains?g.contains(h):true)},x=function(g){return(g=(g?g.ownerDocument||g:0).documentElement)?g.nodeName!==&quot;HTML&quot;:false},ga=function(g,h){var l=[],m=&quot;&quot;,q;for(h=h.nodeType?[h]:h;q=n.match.PSEUDO.exec(g);){m+=q[0];g=g.replace(n.match.PSEUDO,&quot;&quot;)}g=n.relative[g]?g+&quot;*&quot;:g;q=0;for(var p=h.length;q&lt;p;q++)k(g,h[q],l);return k.filter(m,l)};c.find=k;c.expr=k.selectors;c.expr[&quot;:&quot;]=c.expr.filters;c.unique=k.uniqueSort;c.text=a;c.isXMLDoc=x;c.contains=E})();var eb=/Until$/,fb=/^(?:parents|prevUntil|prevAll)/,
+gb=/,/;R=Array.prototype.slice;var Ia=function(a,b,d){if(c.isFunction(b))return c.grep(a,function(e,j){return!!b.call(e,j,e)===d});else if(b.nodeType)return c.grep(a,function(e){return e===b===d});else if(typeof b===&quot;string&quot;){var f=c.grep(a,function(e){return e.nodeType===1});if(Ua.test(b))return c.filter(b,f,!d);else b=c.filter(b,f)}return c.grep(a,function(e){return c.inArray(e,b)&gt;=0===d})};c.fn.extend({find:function(a){for(var b=this.pushStack(&quot;&quot;,&quot;find&quot;,a),d=0,f=0,e=this.length;f&lt;e;f++){d=b.length;
+c.find(a,this[f],b);if(f&gt;0)for(var j=d;j&lt;b.length;j++)for(var i=0;i&lt;d;i++)if(b[i]===b[j]){b.splice(j--,1);break}}return b},has:function(a){var b=c(a);return this.filter(function(){for(var d=0,f=b.length;d&lt;f;d++)if(c.contains(this,b[d]))return true})},not:function(a){return this.pushStack(Ia(this,a,false),&quot;not&quot;,a)},filter:function(a){return this.pushStack(Ia(this,a,true),&quot;filter&quot;,a)},is:function(a){return!!a&amp;&amp;c.filter(a,this).length&gt;0},closest:function(a,b){if(c.isArray(a)){var d=[],f=this[0],e,j=
+{},i;if(f&amp;&amp;a.length){e=0;for(var o=a.length;e&lt;o;e++){i=a[e];j[i]||(j[i]=c.expr.match.POS.test(i)?c(i,b||this.context):i)}for(;f&amp;&amp;f.ownerDocument&amp;&amp;f!==b;){for(i in j){e=j[i];if(e.jquery?e.index(f)&gt;-1:c(f).is(e)){d.push({selector:i,elem:f});delete j[i]}}f=f.parentNode}}return d}var k=c.expr.match.POS.test(a)?c(a,b||this.context):null;return this.map(function(n,r){for(;r&amp;&amp;r.ownerDocument&amp;&amp;r!==b;){if(k?k.index(r)&gt;-1:c(r).is(a))return r;r=r.parentNode}return null})},index:function(a){if(!a||typeof a===
+&quot;string&quot;)return c.inArray(this[0],a?c(a):this.parent().children());return c.inArray(a.jquery?a[0]:a,this)},add:function(a,b){a=typeof a===&quot;string&quot;?c(a,b||this.context):c.makeArray(a);b=c.merge(this.get(),a);return this.pushStack(qa(a[0])||qa(b[0])?b:c.unique(b))},andSelf:function(){return this.add(this.prevObject)}});c.each({parent:function(a){return(a=a.parentNode)&amp;&amp;a.nodeType!==11?a:null},parents:function(a){return c.dir(a,&quot;parentNode&quot;)},parentsUntil:function(a,b,d){return c.dir(a,&quot;parentNode&quot;,
+d)},next:function(a){return c.nth(a,2,&quot;nextSibling&quot;)},prev:function(a){return c.nth(a,2,&quot;previousSibling&quot;)},nextAll:function(a){return c.dir(a,&quot;nextSibling&quot;)},prevAll:function(a){return c.dir(a,&quot;previousSibling&quot;)},nextUntil:function(a,b,d){return c.dir(a,&quot;nextSibling&quot;,d)},prevUntil:function(a,b,d){return c.dir(a,&quot;previousSibling&quot;,d)},siblings:function(a){return c.sibling(a.parentNode.firstChild,a)},children:function(a){return c.sibling(a.firstChild)},contents:function(a){return c.nodeName(a,&quot;iframe&quot;)?
+a.contentDocument||a.contentWindow.document:c.makeArray(a.childNodes)}},function(a,b){c.fn[a]=function(d,f){var e=c.map(this,b,d);eb.test(a)||(f=d);if(f&amp;&amp;typeof f===&quot;string&quot;)e=c.filter(f,e);e=this.length&gt;1?c.unique(e):e;if((this.length&gt;1||gb.test(f))&amp;&amp;fb.test(a))e=e.reverse();return this.pushStack(e,a,R.call(arguments).join(&quot;,&quot;))}});c.extend({filter:function(a,b,d){if(d)a=&quot;:not(&quot;+a+&quot;)&quot;;return c.find.matches(a,b)},dir:function(a,b,d){var f=[];for(a=a[b];a&amp;&amp;a.nodeType!==9&amp;&amp;(d===w||a.nodeType!==1||!c(a).is(d));){a.nodeType===
+1&amp;&amp;f.push(a);a=a[b]}return f},nth:function(a,b,d){b=b||1;for(var f=0;a;a=a[d])if(a.nodeType===1&amp;&amp;++f===b)break;return a},sibling:function(a,b){for(var d=[];a;a=a.nextSibling)a.nodeType===1&amp;&amp;a!==b&amp;&amp;d.push(a);return d}});var Ja=/ jQuery\d+=&quot;(?:\d+|null)&quot;/g,V=/^\s+/,Ka=/(&lt;([\w:]+)[^&gt;]*?)\/&gt;/g,hb=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,La=/&lt;([\w:]+)/,ib=/&lt;tbody/i,jb=/&lt;|&amp;#?\w+;/,ta=/&lt;script|&lt;object|&lt;embed|&lt;option|&lt;style/i,ua=/checked\s*(?:[^=]|=\s*.checked.)/i,Ma=function(a,b,d){return hb.test(d)?
+a:b+&quot;&gt;&lt;/&quot;+d+&quot;&gt;&quot;},F={option:[1,&quot;&lt;select multiple='multiple'&gt;&quot;,&quot;&lt;/select&gt;&quot;],legend:[1,&quot;&lt;fieldset&gt;&quot;,&quot;&lt;/fieldset&gt;&quot;],thead:[1,&quot;&lt;table&gt;&quot;,&quot;&lt;/table&gt;&quot;],tr:[2,&quot;&lt;table&gt;&lt;tbody&gt;&quot;,&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;],td:[3,&quot;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&quot;,&quot;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&quot;],col:[2,&quot;&lt;table&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;colgroup&gt;&quot;,&quot;&lt;/colgroup&gt;&lt;/table&gt;&quot;],area:[1,&quot;&lt;map&gt;&quot;,&quot;&lt;/map&gt;&quot;],_default:[0,&quot;&quot;,&quot;&quot;]};F.optgroup=F.option;F.tbody=F.tfoot=F.colgroup=F.caption=F.thead;F.th=F.td;if(!c.support.htmlSerialize)F._default=[1,&quot;div&lt;div&gt;&quot;,&quot;&lt;/div&gt;&quot;];c.fn.extend({text:function(a){if(c.isFunction(a))return this.each(function(b){var d=
+c(this);d.text(a.call(this,b,d.text()))});if(typeof a!==&quot;object&quot;&amp;&amp;a!==w)return this.empty().append((this[0]&amp;&amp;this[0].ownerDocument||s).createTextNode(a));return c.text(this)},wrapAll:function(a){if(c.isFunction(a))return this.each(function(d){c(this).wrapAll(a.call(this,d))});if(this[0]){var b=c(a,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&amp;&amp;b.insertBefore(this[0]);b.map(function(){for(var d=this;d.firstChild&amp;&amp;d.firstChild.nodeType===1;)d=d.firstChild;return d}).append(this)}return this},
+wrapInner:function(a){if(c.isFunction(a))return this.each(function(b){c(this).wrapInner(a.call(this,b))});return this.each(function(){var b=c(this),d=b.contents();d.length?d.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){c(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){c.nodeName(this,&quot;body&quot;)||c(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&amp;&amp;this.appendChild(a)})},
+prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&amp;&amp;this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&amp;&amp;this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this)});else if(arguments.length){var a=c(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,&quot;before&quot;,arguments)}},after:function(){if(this[0]&amp;&amp;this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,
+this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,&quot;after&quot;,arguments);a.push.apply(a,c(arguments[0]).toArray());return a}},remove:function(a,b){for(var d=0,f;(f=this[d])!=null;d++)if(!a||c.filter(a,[f]).length){if(!b&amp;&amp;f.nodeType===1){c.cleanData(f.getElementsByTagName(&quot;*&quot;));c.cleanData([f])}f.parentNode&amp;&amp;f.parentNode.removeChild(f)}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&amp;&amp;c.cleanData(b.getElementsByTagName(&quot;*&quot;));b.firstChild;)b.removeChild(b.firstChild);
+return this},clone:function(a){var b=this.map(function(){if(!c.support.noCloneEvent&amp;&amp;!c.isXMLDoc(this)){var d=this.outerHTML,f=this.ownerDocument;if(!d){d=f.createElement(&quot;div&quot;);d.appendChild(this.cloneNode(true));d=d.innerHTML}return c.clean([d.replace(Ja,&quot;&quot;).replace(/=([^=&quot;'&gt;\s]+\/)&gt;/g,'=&quot;$1&quot;&gt;').replace(V,&quot;&quot;)],f)[0]}else return this.cloneNode(true)});if(a===true){ra(this,b);ra(this.find(&quot;*&quot;),b.find(&quot;*&quot;))}return b},html:function(a){if(a===w)return this[0]&amp;&amp;this[0].nodeType===1?this[0].innerHTML.replace(Ja,
+&quot;&quot;):null;else if(typeof a===&quot;string&quot;&amp;&amp;!ta.test(a)&amp;&amp;(c.support.leadingWhitespace||!V.test(a))&amp;&amp;!F[(La.exec(a)||[&quot;&quot;,&quot;&quot;])[1].toLowerCase()]){a=a.replace(Ka,Ma);try{for(var b=0,d=this.length;b&lt;d;b++)if(this[b].nodeType===1){c.cleanData(this[b].getElementsByTagName(&quot;*&quot;));this[b].innerHTML=a}}catch(f){this.empty().append(a)}}else c.isFunction(a)?this.each(function(e){var j=c(this),i=j.html();j.empty().append(function(){return a.call(this,e,i)})}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&amp;&amp;
+this[0].parentNode){if(c.isFunction(a))return this.each(function(b){var d=c(this),f=d.html();d.replaceWith(a.call(this,b,f))});if(typeof a!==&quot;string&quot;)a=c(a).detach();return this.each(function(){var b=this.nextSibling,d=this.parentNode;c(this).remove();b?c(b).before(a):c(d).append(a)})}else return this.pushStack(c(c.isFunction(a)?a():a),&quot;replaceWith&quot;,a)},detach:function(a){return this.remove(a,true)},domManip:function(a,b,d){function f(u){return c.nodeName(u,&quot;table&quot;)?u.getElementsByTagName(&quot;tbody&quot;)[0]||
+u.appendChild(u.ownerDocument.createElement(&quot;tbody&quot;)):u}var e,j,i=a[0],o=[],k;if(!c.support.checkClone&amp;&amp;arguments.length===3&amp;&amp;typeof i===&quot;string&quot;&amp;&amp;ua.test(i))return this.each(function(){c(this).domManip(a,b,d,true)});if(c.isFunction(i))return this.each(function(u){var z=c(this);a[0]=i.call(this,u,b?z.html():w);z.domManip(a,b,d)});if(this[0]){e=i&amp;&amp;i.parentNode;e=c.support.parentNode&amp;&amp;e&amp;&amp;e.nodeType===11&amp;&amp;e.childNodes.length===this.length?{fragment:e}:sa(a,this,o);k=e.fragment;if(j=k.childNodes.length===
+1?(k=k.firstChild):k.firstChild){b=b&amp;&amp;c.nodeName(j,&quot;tr&quot;);for(var n=0,r=this.length;n&lt;r;n++)d.call(b?f(this[n],j):this[n],n&gt;0||e.cacheable||this.length&gt;1?k.cloneNode(true):k)}o.length&amp;&amp;c.each(o,Qa)}return this}});c.fragments={};c.each({appendTo:&quot;append&quot;,prependTo:&quot;prepend&quot;,insertBefore:&quot;before&quot;,insertAfter:&quot;after&quot;,replaceAll:&quot;replaceWith&quot;},function(a,b){c.fn[a]=function(d){var f=[];d=c(d);var e=this.length===1&amp;&amp;this[0].parentNode;if(e&amp;&amp;e.nodeType===11&amp;&amp;e.childNodes.length===1&amp;&amp;d.length===1){d[b](this[0]);
+return this}else{e=0;for(var j=d.length;e&lt;j;e++){var i=(e&gt;0?this.clone(true):this).get();c.fn[b].apply(c(d[e]),i);f=f.concat(i)}return this.pushStack(f,a,d.selector)}}});c.extend({clean:function(a,b,d,f){b=b||s;if(typeof b.createElement===&quot;undefined&quot;)b=b.ownerDocument||b[0]&amp;&amp;b[0].ownerDocument||s;for(var e=[],j=0,i;(i=a[j])!=null;j++){if(typeof i===&quot;number&quot;)i+=&quot;&quot;;if(i){if(typeof i===&quot;string&quot;&amp;&amp;!jb.test(i))i=b.createTextNode(i);else if(typeof i===&quot;string&quot;){i=i.replace(Ka,Ma);var o=(La.exec(i)||[&quot;&quot;,
+&quot;&quot;])[1].toLowerCase(),k=F[o]||F._default,n=k[0],r=b.createElement(&quot;div&quot;);for(r.innerHTML=k[1]+i+k[2];n--;)r=r.lastChild;if(!c.support.tbody){n=ib.test(i);o=o===&quot;table&quot;&amp;&amp;!n?r.firstChild&amp;&amp;r.firstChild.childNodes:k[1]===&quot;&lt;table&gt;&quot;&amp;&amp;!n?r.childNodes:[];for(k=o.length-1;k&gt;=0;--k)c.nodeName(o[k],&quot;tbody&quot;)&amp;&amp;!o[k].childNodes.length&amp;&amp;o[k].parentNode.removeChild(o[k])}!c.support.leadingWhitespace&amp;&amp;V.test(i)&amp;&amp;r.insertBefore(b.createTextNode(V.exec(i)[0]),r.firstChild);i=r.childNodes}if(i.nodeType)e.push(i);else e=
+c.merge(e,i)}}if(d)for(j=0;e[j];j++)if(f&amp;&amp;c.nodeName(e[j],&quot;script&quot;)&amp;&amp;(!e[j].type||e[j].type.toLowerCase()===&quot;text/javascript&quot;))f.push(e[j].parentNode?e[j].parentNode.removeChild(e[j]):e[j]);else{e[j].nodeType===1&amp;&amp;e.splice.apply(e,[j+1,0].concat(c.makeArray(e[j].getElementsByTagName(&quot;script&quot;))));d.appendChild(e[j])}return e},cleanData:function(a){for(var b,d,f=c.cache,e=c.event.special,j=c.support.deleteExpando,i=0,o;(o=a[i])!=null;i++)if(d=o[c.expando]){b=f[d];if(b.events)for(var k in b.events)e[k]?
+c.event.remove(o,k):Ca(o,k,b.handle);if(j)delete o[c.expando];else o.removeAttribute&amp;&amp;o.removeAttribute(c.expando);delete f[d]}}});var kb=/z-?index|font-?weight|opacity|zoom|line-?height/i,Na=/alpha\([^)]*\)/,Oa=/opacity=([^)]*)/,ha=/float/i,ia=/-([a-z])/ig,lb=/([A-Z])/g,mb=/^-?\d+(?:px)?$/i,nb=/^-?\d/,ob={position:&quot;absolute&quot;,visibility:&quot;hidden&quot;,display:&quot;block&quot;},pb=[&quot;Left&quot;,&quot;Right&quot;],qb=[&quot;Top&quot;,&quot;Bottom&quot;],rb=s.defaultView&amp;&amp;s.defaultView.getComputedStyle,Pa=c.support.cssFloat?&quot;cssFloat&quot;:&quot;styleFloat&quot;,ja=
+function(a,b){return b.toUpperCase()};c.fn.css=function(a,b){return X(this,a,b,true,function(d,f,e){if(e===w)return c.curCSS(d,f);if(typeof e===&quot;number&quot;&amp;&amp;!kb.test(f))e+=&quot;px&quot;;c.style(d,f,e)})};c.extend({style:function(a,b,d){if(!a||a.nodeType===3||a.nodeType===8)return w;if((b===&quot;width&quot;||b===&quot;height&quot;)&amp;&amp;parseFloat(d)&lt;0)d=w;var f=a.style||a,e=d!==w;if(!c.support.opacity&amp;&amp;b===&quot;opacity&quot;){if(e){f.zoom=1;b=parseInt(d,10)+&quot;&quot;===&quot;NaN&quot;?&quot;&quot;:&quot;alpha(opacity=&quot;+d*100+&quot;)&quot;;a=f.filter||c.curCSS(a,&quot;filter&quot;)||&quot;&quot;;f.filter=
+Na.test(a)?a.replace(Na,b):b}return f.filter&amp;&amp;f.filter.indexOf(&quot;opacity=&quot;)&gt;=0?parseFloat(Oa.exec(f.filter)[1])/100+&quot;&quot;:&quot;&quot;}if(ha.test(b))b=Pa;b=b.replace(ia,ja);if(e)f[b]=d;return f[b]},css:function(a,b,d,f){if(b===&quot;width&quot;||b===&quot;height&quot;){var e,j=b===&quot;width&quot;?pb:qb;function i(){e=b===&quot;width&quot;?a.offsetWidth:a.offsetHeight;f!==&quot;border&quot;&amp;&amp;c.each(j,function(){f||(e-=parseFloat(c.curCSS(a,&quot;padding&quot;+this,true))||0);if(f===&quot;margin&quot;)e+=parseFloat(c.curCSS(a,&quot;margin&quot;+this,true))||0;else e-=parseFloat(c.curCSS(a,
+&quot;border&quot;+this+&quot;Width&quot;,true))||0})}a.offsetWidth!==0?i():c.swap(a,ob,i);return Math.max(0,Math.round(e))}return c.curCSS(a,b,d)},curCSS:function(a,b,d){var f,e=a.style;if(!c.support.opacity&amp;&amp;b===&quot;opacity&quot;&amp;&amp;a.currentStyle){f=Oa.test(a.currentStyle.filter||&quot;&quot;)?parseFloat(RegExp.$1)/100+&quot;&quot;:&quot;&quot;;return f===&quot;&quot;?&quot;1&quot;:f}if(ha.test(b))b=Pa;if(!d&amp;&amp;e&amp;&amp;e[b])f=e[b];else if(rb){if(ha.test(b))b=&quot;float&quot;;b=b.replace(lb,&quot;-$1&quot;).toLowerCase();e=a.ownerDocument.defaultView;if(!e)return null;if(a=e.getComputedStyle(a,null))f=
+a.getPropertyValue(b);if(b===&quot;opacity&quot;&amp;&amp;f===&quot;&quot;)f=&quot;1&quot;}else if(a.currentStyle){d=b.replace(ia,ja);f=a.currentStyle[b]||a.currentStyle[d];if(!mb.test(f)&amp;&amp;nb.test(f)){b=e.left;var j=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;e.left=d===&quot;fontSize&quot;?&quot;1em&quot;:f||0;f=e.pixelLeft+&quot;px&quot;;e.left=b;a.runtimeStyle.left=j}}return f},swap:function(a,b,d){var f={};for(var e in b){f[e]=a.style[e];a.style[e]=b[e]}d.call(a);for(e in b)a.style[e]=f[e]}});if(c.expr&amp;&amp;c.expr.filters){c.expr.filters.hidden=function(a){var b=
+a.offsetWidth,d=a.offsetHeight,f=a.nodeName.toLowerCase()===&quot;tr&quot;;return b===0&amp;&amp;d===0&amp;&amp;!f?true:b&gt;0&amp;&amp;d&gt;0&amp;&amp;!f?false:c.curCSS(a,&quot;display&quot;)===&quot;none&quot;};c.expr.filters.visible=function(a){return!c.expr.filters.hidden(a)}}var sb=J(),tb=/&lt;script(.|\s)*?\/script&gt;/gi,ub=/select|textarea/i,vb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,N=/=\?(&amp;|$)/,ka=/\?/,wb=/(\?|&amp;)_=.*?(&amp;|$)/,xb=/^(\w+:)?\/\/([^\/?#]+)/,yb=/%20/g,zb=c.fn.load;c.fn.extend({load:function(a,b,d){if(typeof a!==
+&quot;string&quot;)return zb.call(this,a);else if(!this.length)return this;var f=a.indexOf(&quot; &quot;);if(f&gt;=0){var e=a.slice(f,a.length);a=a.slice(0,f)}f=&quot;GET&quot;;if(b)if(c.isFunction(b)){d=b;b=null}else if(typeof b===&quot;object&quot;){b=c.param(b,c.ajaxSettings.traditional);f=&quot;POST&quot;}var j=this;c.ajax({url:a,type:f,dataType:&quot;html&quot;,data:b,complete:function(i,o){if(o===&quot;success&quot;||o===&quot;notmodified&quot;)j.html(e?c(&quot;&lt;div /&gt;&quot;).append(i.responseText.replace(tb,&quot;&quot;)).find(e):i.responseText);d&amp;&amp;j.each(d,[i.responseText,o,i])}});return this},
+serialize:function(){return c.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?c.makeArray(this.elements):this}).filter(function(){return this.name&amp;&amp;!this.disabled&amp;&amp;(this.checked||ub.test(this.nodeName)||vb.test(this.type))}).map(function(a,b){a=c(this).val();return a==null?null:c.isArray(a)?c.map(a,function(d){return{name:b.name,value:d}}):{name:b.name,value:a}}).get()}});c.each(&quot;ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend&quot;.split(&quot; &quot;),
+function(a,b){c.fn[b]=function(d){return this.bind(b,d)}});c.extend({get:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b=null}return c.ajax({type:&quot;GET&quot;,url:a,data:b,success:d,dataType:f})},getScript:function(a,b){return c.get(a,null,b,&quot;script&quot;)},getJSON:function(a,b,d){return c.get(a,b,d,&quot;json&quot;)},post:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b={}}return c.ajax({type:&quot;POST&quot;,url:a,data:b,success:d,dataType:f})},ajaxSetup:function(a){c.extend(c.ajaxSettings,a)},ajaxSettings:{url:location.href,
+global:true,type:&quot;GET&quot;,contentType:&quot;application/x-www-form-urlencoded&quot;,processData:true,async:true,xhr:A.XMLHttpRequest&amp;&amp;(A.location.protocol!==&quot;file:&quot;||!A.ActiveXObject)?function(){return new A.XMLHttpRequest}:function(){try{return new A.ActiveXObject(&quot;Microsoft.XMLHTTP&quot;)}catch(a){}},accepts:{xml:&quot;application/xml, text/xml&quot;,html:&quot;text/html&quot;,script:&quot;text/javascript, application/javascript&quot;,json:&quot;application/json, text/javascript&quot;,text:&quot;text/plain&quot;,_default:&quot;*/*&quot;}},lastModified:{},etag:{},ajax:function(a){function b(){e.success&amp;&amp;
+e.success.call(k,o,i,x);e.global&amp;&amp;f(&quot;ajaxSuccess&quot;,[x,e])}function d(){e.complete&amp;&amp;e.complete.call(k,x,i);e.global&amp;&amp;f(&quot;ajaxComplete&quot;,[x,e]);e.global&amp;&amp;!--c.active&amp;&amp;c.event.trigger(&quot;ajaxStop&quot;)}function f(q,p){(e.context?c(e.context):c.event).trigger(q,p)}var e=c.extend(true,{},c.ajaxSettings,a),j,i,o,k=a&amp;&amp;a.context||e,n=e.type.toUpperCase();if(e.data&amp;&amp;e.processData&amp;&amp;typeof e.data!==&quot;string&quot;)e.data=c.param(e.data,e.traditional);if(e.dataType===&quot;jsonp&quot;){if(n===&quot;GET&quot;)N.test(e.url)||(e.url+=(ka.test(e.url)?
+&quot;&amp;&quot;:&quot;?&quot;)+(e.jsonp||&quot;callback&quot;)+&quot;=?&quot;);else if(!e.data||!N.test(e.data))e.data=(e.data?e.data+&quot;&amp;&quot;:&quot;&quot;)+(e.jsonp||&quot;callback&quot;)+&quot;=?&quot;;e.dataType=&quot;json&quot;}if(e.dataType===&quot;json&quot;&amp;&amp;(e.data&amp;&amp;N.test(e.data)||N.test(e.url))){j=e.jsonpCallback||&quot;jsonp&quot;+sb++;if(e.data)e.data=(e.data+&quot;&quot;).replace(N,&quot;=&quot;+j+&quot;$1&quot;);e.url=e.url.replace(N,&quot;=&quot;+j+&quot;$1&quot;);e.dataType=&quot;script&quot;;A[j]=A[j]||function(q){o=q;b();d();A[j]=w;try{delete A[j]}catch(p){}z&amp;&amp;z.removeChild(C)}}if(e.dataType===&quot;script&quot;&amp;&amp;e.cache===null)e.cache=false;if(e.cache===
+false&amp;&amp;n===&quot;GET&quot;){var r=J(),u=e.url.replace(wb,&quot;$1_=&quot;+r+&quot;$2&quot;);e.url=u+(u===e.url?(ka.test(e.url)?&quot;&amp;&quot;:&quot;?&quot;)+&quot;_=&quot;+r:&quot;&quot;)}if(e.data&amp;&amp;n===&quot;GET&quot;)e.url+=(ka.test(e.url)?&quot;&amp;&quot;:&quot;?&quot;)+e.data;e.global&amp;&amp;!c.active++&amp;&amp;c.event.trigger(&quot;ajaxStart&quot;);r=(r=xb.exec(e.url))&amp;&amp;(r[1]&amp;&amp;r[1]!==location.protocol||r[2]!==location.host);if(e.dataType===&quot;script&quot;&amp;&amp;n===&quot;GET&quot;&amp;&amp;r){var z=s.getElementsByTagName(&quot;head&quot;)[0]||s.documentElement,C=s.createElement(&quot;script&quot;);C.src=e.url;if(e.scriptCharset)C.charset=e.scriptCharset;if(!j){var B=
+false;C.onload=C.onreadystatechange=function(){if(!B&amp;&amp;(!this.readyState||this.readyState===&quot;loaded&quot;||this.readyState===&quot;complete&quot;)){B=true;b();d();C.onload=C.onreadystatechange=null;z&amp;&amp;C.parentNode&amp;&amp;z.removeChild(C)}}}z.insertBefore(C,z.firstChild);return w}var E=false,x=e.xhr();if(x){e.username?x.open(n,e.url,e.async,e.username,e.password):x.open(n,e.url,e.async);try{if(e.data||a&amp;&amp;a.contentType)x.setRequestHeader(&quot;Content-Type&quot;,e.contentType);if(e.ifModified){c.lastModified[e.url]&amp;&amp;x.setRequestHeader(&quot;If-Modified-Since&quot;,
+c.lastModified[e.url]);c.etag[e.url]&amp;&amp;x.setRequestHeader(&quot;If-None-Match&quot;,c.etag[e.url])}r||x.setRequestHeader(&quot;X-Requested-With&quot;,&quot;XMLHttpRequest&quot;);x.setRequestHeader(&quot;Accept&quot;,e.dataType&amp;&amp;e.accepts[e.dataType]?e.accepts[e.dataType]+&quot;, */*&quot;:e.accepts._default)}catch(ga){}if(e.beforeSend&amp;&amp;e.beforeSend.call(k,x,e)===false){e.global&amp;&amp;!--c.active&amp;&amp;c.event.trigger(&quot;ajaxStop&quot;);x.abort();return false}e.global&amp;&amp;f(&quot;ajaxSend&quot;,[x,e]);var g=x.onreadystatechange=function(q){if(!x||x.readyState===0||q===&quot;abort&quot;){E||
+d();E=true;if(x)x.onreadystatechange=c.noop}else if(!E&amp;&amp;x&amp;&amp;(x.readyState===4||q===&quot;timeout&quot;)){E=true;x.onreadystatechange=c.noop;i=q===&quot;timeout&quot;?&quot;timeout&quot;:!c.httpSuccess(x)?&quot;error&quot;:e.ifModified&amp;&amp;c.httpNotModified(x,e.url)?&quot;notmodified&quot;:&quot;success&quot;;var p;if(i===&quot;success&quot;)try{o=c.httpData(x,e.dataType,e)}catch(v){i=&quot;parsererror&quot;;p=v}if(i===&quot;success&quot;||i===&quot;notmodified&quot;)j||b();else c.handleError(e,x,i,p);d();q===&quot;timeout&quot;&amp;&amp;x.abort();if(e.async)x=null}};try{var h=x.abort;x.abort=function(){x&amp;&amp;h.call(x);
+g(&quot;abort&quot;)}}catch(l){}e.async&amp;&amp;e.timeout&gt;0&amp;&amp;setTimeout(function(){x&amp;&amp;!E&amp;&amp;g(&quot;timeout&quot;)},e.timeout);try{x.send(n===&quot;POST&quot;||n===&quot;PUT&quot;||n===&quot;DELETE&quot;?e.data:null)}catch(m){c.handleError(e,x,null,m);d()}e.async||g();return x}},handleError:function(a,b,d,f){if(a.error)a.error.call(a.context||a,b,d,f);if(a.global)(a.context?c(a.context):c.event).trigger(&quot;ajaxError&quot;,[b,a,f])},active:0,httpSuccess:function(a){try{return!a.status&amp;&amp;location.protocol===&quot;file:&quot;||a.status&gt;=200&amp;&amp;a.status&lt;300||a.status===304||a.status===
+1223||a.status===0}catch(b){}return false},httpNotModified:function(a,b){var d=a.getResponseHeader(&quot;Last-Modified&quot;),f=a.getResponseHeader(&quot;Etag&quot;);if(d)c.lastModified[b]=d;if(f)c.etag[b]=f;return a.status===304||a.status===0},httpData:function(a,b,d){var f=a.getResponseHeader(&quot;content-type&quot;)||&quot;&quot;,e=b===&quot;xml&quot;||!b&amp;&amp;f.indexOf(&quot;xml&quot;)&gt;=0;a=e?a.responseXML:a.responseText;e&amp;&amp;a.documentElement.nodeName===&quot;parsererror&quot;&amp;&amp;c.error(&quot;parsererror&quot;);if(d&amp;&amp;d.dataFilter)a=d.dataFilter(a,b);if(typeof a===&quot;string&quot;)if(b===
+&quot;json&quot;||!b&amp;&amp;f.indexOf(&quot;json&quot;)&gt;=0)a=c.parseJSON(a);else if(b===&quot;script&quot;||!b&amp;&amp;f.indexOf(&quot;javascript&quot;)&gt;=0)c.globalEval(a);return a},param:function(a,b){function d(i,o){if(c.isArray(o))c.each(o,function(k,n){b||/\[\]$/.test(i)?f(i,n):d(i+&quot;[&quot;+(typeof n===&quot;object&quot;||c.isArray(n)?k:&quot;&quot;)+&quot;]&quot;,n)});else!b&amp;&amp;o!=null&amp;&amp;typeof o===&quot;object&quot;?c.each(o,function(k,n){d(i+&quot;[&quot;+k+&quot;]&quot;,n)}):f(i,o)}function f(i,o){o=c.isFunction(o)?o():o;e[e.length]=encodeURIComponent(i)+&quot;=&quot;+encodeURIComponent(o)}var e=[];if(b===w)b=c.ajaxSettings.traditional;
+if(c.isArray(a)||a.jquery)c.each(a,function(){f(this.name,this.value)});else for(var j in a)d(j,a[j]);return e.join(&quot;&amp;&quot;).replace(yb,&quot;+&quot;)}});var la={},Ab=/toggle|show|hide/,Bb=/^([+-]=)?([\d+-.]+)(.*)$/,W,va=[[&quot;height&quot;,&quot;marginTop&quot;,&quot;marginBottom&quot;,&quot;paddingTop&quot;,&quot;paddingBottom&quot;],[&quot;width&quot;,&quot;marginLeft&quot;,&quot;marginRight&quot;,&quot;paddingLeft&quot;,&quot;paddingRight&quot;],[&quot;opacity&quot;]];c.fn.extend({show:function(a,b){if(a||a===0)return this.animate(K(&quot;show&quot;,3),a,b);else{a=0;for(b=this.length;a&lt;b;a++){var d=c.data(this[a],&quot;olddisplay&quot;);
+this[a].style.display=d||&quot;&quot;;if(c.css(this[a],&quot;display&quot;)===&quot;none&quot;){d=this[a].nodeName;var f;if(la[d])f=la[d];else{var e=c(&quot;&lt;&quot;+d+&quot; /&gt;&quot;).appendTo(&quot;body&quot;);f=e.css(&quot;display&quot;);if(f===&quot;none&quot;)f=&quot;block&quot;;e.remove();la[d]=f}c.data(this[a],&quot;olddisplay&quot;,f)}}a=0;for(b=this.length;a&lt;b;a++)this[a].style.display=c.data(this[a],&quot;olddisplay&quot;)||&quot;&quot;;return this}},hide:function(a,b){if(a||a===0)return this.animate(K(&quot;hide&quot;,3),a,b);else{a=0;for(b=this.length;a&lt;b;a++){var d=c.data(this[a],&quot;olddisplay&quot;);!d&amp;&amp;d!==&quot;none&quot;&amp;&amp;c.data(this[a],
+&quot;olddisplay&quot;,c.css(this[a],&quot;display&quot;))}a=0;for(b=this.length;a&lt;b;a++)this[a].style.display=&quot;none&quot;;return this}},_toggle:c.fn.toggle,toggle:function(a,b){var d=typeof a===&quot;boolean&quot;;if(c.isFunction(a)&amp;&amp;c.isFunction(b))this._toggle.apply(this,arguments);else a==null||d?this.each(function(){var f=d?a:c(this).is(&quot;:hidden&quot;);c(this)[f?&quot;show&quot;:&quot;hide&quot;]()}):this.animate(K(&quot;toggle&quot;,3),a,b);return this},fadeTo:function(a,b,d){return this.filter(&quot;:hidden&quot;).css(&quot;opacity&quot;,0).show().end().animate({opacity:b},a,d)},
+animate:function(a,b,d,f){var e=c.speed(b,d,f);if(c.isEmptyObject(a))return this.each(e.complete);return this[e.queue===false?&quot;each&quot;:&quot;queue&quot;](function(){var j=c.extend({},e),i,o=this.nodeType===1&amp;&amp;c(this).is(&quot;:hidden&quot;),k=this;for(i in a){var n=i.replace(ia,ja);if(i!==n){a[n]=a[i];delete a[i];i=n}if(a[i]===&quot;hide&quot;&amp;&amp;o||a[i]===&quot;show&quot;&amp;&amp;!o)return j.complete.call(this);if((i===&quot;height&quot;||i===&quot;width&quot;)&amp;&amp;this.style){j.display=c.css(this,&quot;display&quot;);j.overflow=this.style.overflow}if(c.isArray(a[i])){(j.specialEasing=
+j.specialEasing||{})[i]=a[i][1];a[i]=a[i][0]}}if(j.overflow!=null)this.style.overflow=&quot;hidden&quot;;j.curAnim=c.extend({},a);c.each(a,function(r,u){var z=new c.fx(k,j,r);if(Ab.test(u))z[u===&quot;toggle&quot;?o?&quot;show&quot;:&quot;hide&quot;:u](a);else{var C=Bb.exec(u),B=z.cur(true)||0;if(C){u=parseFloat(C[2]);var E=C[3]||&quot;px&quot;;if(E!==&quot;px&quot;){k.style[r]=(u||1)+E;B=(u||1)/z.cur(true)*B;k.style[r]=B+E}if(C[1])u=(C[1]===&quot;-=&quot;?-1:1)*u+B;z.custom(B,u,E)}else z.custom(B,u,&quot;&quot;)}});return true})},stop:function(a,b){var d=c.timers;a&amp;&amp;this.queue([]);
+this.each(function(){for(var f=d.length-1;f&gt;=0;f--)if(d[f].elem===this){b&amp;&amp;d[f](true);d.splice(f,1)}});b||this.dequeue();return this}});c.each({slideDown:K(&quot;show&quot;,1),slideUp:K(&quot;hide&quot;,1),slideToggle:K(&quot;toggle&quot;,1),fadeIn:{opacity:&quot;show&quot;},fadeOut:{opacity:&quot;hide&quot;}},function(a,b){c.fn[a]=function(d,f){return this.animate(b,d,f)}});c.extend({speed:function(a,b,d){var f=a&amp;&amp;typeof a===&quot;object&quot;?a:{complete:d||!d&amp;&amp;b||c.isFunction(a)&amp;&amp;a,duration:a,easing:d&amp;&amp;b||b&amp;&amp;!c.isFunction(b)&amp;&amp;b};f.duration=c.fx.off?0:typeof f.duration===
+&quot;number&quot;?f.duration:c.fx.speeds[f.duration]||c.fx.speeds._default;f.old=f.complete;f.complete=function(){f.queue!==false&amp;&amp;c(this).dequeue();c.isFunction(f.old)&amp;&amp;f.old.call(this)};return f},easing:{linear:function(a,b,d,f){return d+f*a},swing:function(a,b,d,f){return(-Math.cos(a*Math.PI)/2+0.5)*f+d}},timers:[],fx:function(a,b,d){this.options=b;this.elem=a;this.prop=d;if(!b.orig)b.orig={}}});c.fx.prototype={update:function(){this.options.step&amp;&amp;this.options.step.call(this.elem,this.now,this);(c.fx.step[this.prop]||
+c.fx.step._default)(this);if((this.prop===&quot;height&quot;||this.prop===&quot;width&quot;)&amp;&amp;this.elem.style)this.elem.style.display=&quot;block&quot;},cur:function(a){if(this.elem[this.prop]!=null&amp;&amp;(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];return(a=parseFloat(c.css(this.elem,this.prop,a)))&amp;&amp;a&gt;-10000?a:parseFloat(c.curCSS(this.elem,this.prop))||0},custom:function(a,b,d){function f(j){return e.step(j)}this.startTime=J();this.start=a;this.end=b;this.unit=d||this.unit||&quot;px&quot;;this.now=this.start;
+this.pos=this.state=0;var e=this;f.elem=this.elem;if(f()&amp;&amp;c.timers.push(f)&amp;&amp;!W)W=setInterval(c.fx.tick,13)},show:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop===&quot;width&quot;||this.prop===&quot;height&quot;?1:0,this.cur());c(this.elem).show()},hide:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var b=J(),d=true;if(a||b&gt;=this.options.duration+this.startTime){this.now=
+this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var f in this.options.curAnim)if(this.options.curAnim[f]!==true)d=false;if(d){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;a=c.data(this.elem,&quot;olddisplay&quot;);this.elem.style.display=a?a:this.options.display;if(c.css(this.elem,&quot;display&quot;)===&quot;none&quot;)this.elem.style.display=&quot;block&quot;}this.options.hide&amp;&amp;c(this.elem).hide();if(this.options.hide||this.options.show)for(var e in this.options.curAnim)c.style(this.elem,
+e,this.options.orig[e]);this.options.complete.call(this.elem)}return false}else{e=b-this.startTime;this.state=e/this.options.duration;a=this.options.easing||(c.easing.swing?&quot;swing&quot;:&quot;linear&quot;);this.pos=c.easing[this.options.specialEasing&amp;&amp;this.options.specialEasing[this.prop]||a](this.state,e,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};c.extend(c.fx,{tick:function(){for(var a=c.timers,b=0;b&lt;a.length;b++)a[b]()||a.splice(b--,1);a.length||
+c.fx.stop()},stop:function(){clearInterval(W);W=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){c.style(a.elem,&quot;opacity&quot;,a.now)},_default:function(a){if(a.elem.style&amp;&amp;a.elem.style[a.prop]!=null)a.elem.style[a.prop]=(a.prop===&quot;width&quot;||a.prop===&quot;height&quot;?Math.max(0,a.now):a.now)+a.unit;else a.elem[a.prop]=a.now}}});if(c.expr&amp;&amp;c.expr.filters)c.expr.filters.animated=function(a){return c.grep(c.timers,function(b){return a===b.elem}).length};c.fn.offset=&quot;getBoundingClientRect&quot;in s.documentElement?
+function(a){var b=this[0];if(a)return this.each(function(e){c.offset.setOffset(this,a,e)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);var d=b.getBoundingClientRect(),f=b.ownerDocument;b=f.body;f=f.documentElement;return{top:d.top+(self.pageYOffset||c.support.boxModel&amp;&amp;f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:d.left+(self.pageXOffset||c.support.boxModel&amp;&amp;f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)}}:function(a){var b=
+this[0];if(a)return this.each(function(r){c.offset.setOffset(this,a,r)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);c.offset.initialize();var d=b.offsetParent,f=b,e=b.ownerDocument,j,i=e.documentElement,o=e.body;f=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var k=b.offsetTop,n=b.offsetLeft;(b=b.parentNode)&amp;&amp;b!==o&amp;&amp;b!==i;){if(c.offset.supportsFixedPosition&amp;&amp;f.position===&quot;fixed&quot;)break;j=e?e.getComputedStyle(b,null):b.currentStyle;
+k-=b.scrollTop;n-=b.scrollLeft;if(b===d){k+=b.offsetTop;n+=b.offsetLeft;if(c.offset.doesNotAddBorder&amp;&amp;!(c.offset.doesAddBorderForTableAndCells&amp;&amp;/^t(able|d|h)$/i.test(b.nodeName))){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0}f=d;d=b.offsetParent}if(c.offset.subtractsBorderForOverflowNotVisible&amp;&amp;j.overflow!==&quot;visible&quot;){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0}f=j}if(f.position===&quot;relative&quot;||f.position===&quot;static&quot;){k+=o.offsetTop;n+=o.offsetLeft}if(c.offset.supportsFixedPosition&amp;&amp;
+f.position===&quot;fixed&quot;){k+=Math.max(i.scrollTop,o.scrollTop);n+=Math.max(i.scrollLeft,o.scrollLeft)}return{top:k,left:n}};c.offset={initialize:function(){var a=s.body,b=s.createElement(&quot;div&quot;),d,f,e,j=parseFloat(c.curCSS(a,&quot;marginTop&quot;,true))||0;c.extend(b.style,{position:&quot;absolute&quot;,top:0,left:0,margin:0,border:0,width:&quot;1px&quot;,height:&quot;1px&quot;,visibility:&quot;hidden&quot;});b.innerHTML=&quot;&lt;div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;;
+a.insertBefore(b,a.firstChild);d=b.firstChild;f=d.firstChild;e=d.nextSibling.firstChild.firstChild;this.doesNotAddBorder=f.offsetTop!==5;this.doesAddBorderForTableAndCells=e.offsetTop===5;f.style.position=&quot;fixed&quot;;f.style.top=&quot;20px&quot;;this.supportsFixedPosition=f.offsetTop===20||f.offsetTop===15;f.style.position=f.style.top=&quot;&quot;;d.style.overflow=&quot;hidden&quot;;d.style.position=&quot;relative&quot;;this.subtractsBorderForOverflowNotVisible=f.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==j;a.removeChild(b);
+c.offset.initialize=c.noop},bodyOffset:function(a){var b=a.offsetTop,d=a.offsetLeft;c.offset.initialize();if(c.offset.doesNotIncludeMarginInBodyOffset){b+=parseFloat(c.curCSS(a,&quot;marginTop&quot;,true))||0;d+=parseFloat(c.curCSS(a,&quot;marginLeft&quot;,true))||0}return{top:b,left:d}},setOffset:function(a,b,d){if(/static/.test(c.curCSS(a,&quot;position&quot;)))a.style.position=&quot;relative&quot;;var f=c(a),e=f.offset(),j=parseInt(c.curCSS(a,&quot;top&quot;,true),10)||0,i=parseInt(c.curCSS(a,&quot;left&quot;,true),10)||0;if(c.isFunction(b))b=b.call(a,
+d,e);d={top:b.top-e.top+j,left:b.left-e.left+i};&quot;using&quot;in b?b.using.call(a,d):f.css(d)}};c.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),d=this.offset(),f=/^body|html$/i.test(b[0].nodeName)?{top:0,left:0}:b.offset();d.top-=parseFloat(c.curCSS(a,&quot;marginTop&quot;,true))||0;d.left-=parseFloat(c.curCSS(a,&quot;marginLeft&quot;,true))||0;f.top+=parseFloat(c.curCSS(b[0],&quot;borderTopWidth&quot;,true))||0;f.left+=parseFloat(c.curCSS(b[0],&quot;borderLeftWidth&quot;,true))||0;return{top:d.top-
+f.top,left:d.left-f.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||s.body;a&amp;&amp;!/^body|html$/i.test(a.nodeName)&amp;&amp;c.css(a,&quot;position&quot;)===&quot;static&quot;;)a=a.offsetParent;return a})}});c.each([&quot;Left&quot;,&quot;Top&quot;],function(a,b){var d=&quot;scroll&quot;+b;c.fn[d]=function(f){var e=this[0],j;if(!e)return null;if(f!==w)return this.each(function(){if(j=wa(this))j.scrollTo(!a?f:c(j).scrollLeft(),a?f:c(j).scrollTop());else this[d]=f});else return(j=wa(e))?&quot;pageXOffset&quot;in j?j[a?&quot;pageYOffset&quot;:
+&quot;pageXOffset&quot;]:c.support.boxModel&amp;&amp;j.document.documentElement[d]||j.document.body[d]:e[d]}});c.each([&quot;Height&quot;,&quot;Width&quot;],function(a,b){var d=b.toLowerCase();c.fn[&quot;inner&quot;+b]=function(){return this[0]?c.css(this[0],d,false,&quot;padding&quot;):null};c.fn[&quot;outer&quot;+b]=function(f){return this[0]?c.css(this[0],d,false,f?&quot;margin&quot;:&quot;border&quot;):null};c.fn[d]=function(f){var e=this[0];if(!e)return f==null?null:this;if(c.isFunction(f))return this.each(function(j){var i=c(this);i[d](f.call(this,j,i[d]()))});return&quot;scrollTo&quot;in
+e&amp;&amp;e.document?e.document.compatMode===&quot;CSS1Compat&quot;&amp;&amp;e.document.documentElement[&quot;client&quot;+b]||e.document.body[&quot;client&quot;+b]:e.nodeType===9?Math.max(e.documentElement[&quot;client&quot;+b],e.body[&quot;scroll&quot;+b],e.documentElement[&quot;scroll&quot;+b],e.body[&quot;offset&quot;+b],e.documentElement[&quot;offset&quot;+b]):f===w?c.css(e,d):this.css(d,typeof f===&quot;string&quot;?f:f+&quot;px&quot;)}});A.jQuery=A.$=c})(window);

Modified: trunk/pages/util.js
===================================================================
--- trunk/pages/util.js	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/pages/util.js	2010-07-09 23:06:45 UTC (rev 91)
@@ -11,4 +11,22 @@
   } else  {
     return false;
   }
+}
+
+function toggleNumeration() {
+    // citymap
+    if (jQuery(&quot;#numbers&quot;, window.parent.frames[&quot;left&quot;].document).css(&quot;visibility&quot;) == &quot;visible&quot;) {
+        jQuery(&quot;#numbers&quot;, window.parent.frames[&quot;left&quot;].document).css(&quot;visibility&quot;, &quot;hidden&quot;);
+        jQuery(&quot;#enumeration&quot;, window.parent.frames[&quot;right&quot;].document).html(&quot;&lt;img src=\&quot;../images/pow-in-numbers-dark.png\&quot; height=\&quot;17\&quot; title=\&quot;Nummern einblenden\&quot; alt=\&quot;Nummern einblenden\&quot; border=\&quot;0\&quot;&gt;&quot;);
+    } else {
+        jQuery(&quot;#numbers&quot;, window.parent.frames[&quot;left&quot;].document).css(&quot;visibility&quot;, &quot;visible&quot;);
+        jQuery(&quot;#enumeration&quot;, window.parent.frames[&quot;right&quot;].document).html(&quot;&lt;img src=\&quot;../images/pow-in-numbers-bright.png\&quot; height=\&quot;17\&quot; title=\&quot;Nummern ausblenden\&quot; alt=\&quot;Nummern ausblenden\&quot; border=\&quot;0\&quot;&gt;&quot;);
+    }
+    /** sidebar
+    if (jQuery(&quot;#numbers&quot;, window.parent.frames[&quot;right&quot;].document).css(&quot;visibility&quot;) == &quot;visible&quot;) {
+        jQuery(&quot;#numbers&quot;, window.parent.frames[&quot;right&quot;].document).css(&quot;visibility&quot;, &quot;hidden&quot;);
+    } else {
+        jQuery(&quot;#numbers&quot;, window.parent.frames[&quot;right&quot;].document).css(&quot;visibility&quot;, &quot;visible&quot;);
+    }*/
+    //alert(&quot;changed-css attributes&quot;);
 }
\ No newline at end of file

Modified: trunk/src/de/kiezatlas/deepamehta/BrowseServlet.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/BrowseServlet.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/BrowseServlet.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -32,12 +32,12 @@
 
 
 /**
- * Kiezatlas 1.6.2&lt;br&gt;
+ * Kiezatlas 1.6.5&lt;br&gt;
  * Requires DeepaMehta 2.0b8
  * &lt;p&gt;
- * Last change: 11.8.2008&lt;br&gt;
- * J&ouml;rg Richter&lt;br&gt;
- * <A HREF="https://lists.berlios.de/mailman/listinfo/kiezatlas-svn">jri at deepamehta.de</A>
+ * Last change: 15.06.2010&lt;br&gt;
+ * J&ouml;rg Richter / Malte Rei&szlig;ig &lt;br&gt;
+ * <A HREF="https://lists.berlios.de/mailman/listinfo/kiezatlas-svn">jri at deepamehta.de</A> / <A HREF="https://lists.berlios.de/mailman/listinfo/kiezatlas-svn">mre at deepamehta.de</A>
  */
 public class BrowseServlet extends DeepaMehtaServlet implements KiezAtlas {
 
@@ -71,6 +71,7 @@
 				initStylesheet(session);		// relies on city map
 				initSiteLogo(session);			// relies on city map
 				initSiteLinks(session);			// relies on city map
+                initSelectedCatAttribute(session);
 				//
 				updateShapes(session);			// relies on shape types;
 				return PAGE_FRAMESET;
@@ -79,8 +80,8 @@
 				session.setAttribute(&quot;error&quot;, e.getMessage());
 				return PAGE_ERROR;
 			}
-			
-		} 		
+
+		}
 		// session timeout?
 		if (getCityMap(session) == null) {
 			System.out.println(&quot;*** Session Expired ***&quot;);
@@ -103,7 +104,7 @@
 						session.setAttribute(&quot;defaultCriteria&quot;, &quot;0&quot;);
 						setSearchMode(&quot;0&quot;, session);	// ### was SEARCHMODE_BY_CATEGORY
 					}
-					return PAGE_CATEGORY_LIST; 
+					return PAGE_CATEGORY_LIST;
 				} else {
 					// otherwise list all institutions
 					setSearchMode(SEARCHMODE_BY_NAME, session);
@@ -146,6 +147,7 @@
 			return PAGE_GEO_LIST;
 		// info
 		} else if (action.equals(ACTION_SHOW_GEO_INFO)) {
+            // ### should also set the current HotspotMarker (e.g. after searchByCategory)
 			String geoID = params.getValue(&quot;id&quot;);
 			setSelectedGeo(geoID, session);
 			TopicBean topicBean = as.createTopicBean(geoID, 1);
@@ -198,6 +200,8 @@
 			Vector selectedCats = getSelectedCats(session);
 			session.setAttribute(&quot;categories&quot;, categories);
 			session.setAttribute(&quot;selectedCats&quot;, selectedCats);
+            // disable enumeration rendering
+            session.setAttribute(&quot;enumerationFlag&quot;, false);
 			// hotspots
 			setCategoryHotspots(session);
 			// clear marker
@@ -208,15 +212,19 @@
 			String instTypeID = getInstitutionType(session).getID();
 			String searchMode = getSearchMode(session);
 			Vector insts;
+            // enable the rendering of enumeration
+            session.setAttribute(&quot;enumerationFlag&quot;, true);
 			if (searchMode.equals(SEARCHMODE_BY_NAME)) {
 				insts = cm.getViewTopics(mapID, 1, instTypeID, getSearchValue(session));
 				// hotspots
 				setHotspots(insts, ICON_HOTSPOT, session);
+                session.setAttribute(&quot;selectedCatId&quot;, &quot;&quot;);
 			} else {
 				String catID = params.getValue(&quot;id&quot;);
-				insts = cm.getRelatedViewTopics(mapID, 1, catID, ASSOCTYPE_ASSOCIATION, instTypeID, 1);	// ### copy in setCategoryHotspots() 
-				// hotspots
-				setCategoryHotspots(session);
+				insts = cm.getRelatedViewTopics(mapID, 1, catID, ASSOCTYPE_ASSOCIATION, instTypeID, 1);	// ### copy in setCategoryHotspots()
+				// hotspots + return the index of the current CatID in the multi-dimensional hotspot vector
+				int catIndex = setSearchedCategoryHotspots(session, catID);
+                session.setAttribute(&quot;selectedCatId&quot;, &quot;&quot;+catIndex+&quot;&quot;);
 			}
 			session.setAttribute(&quot;institutions&quot;, insts);
 			// categories &amp; addresses
@@ -229,10 +237,10 @@
 					// categories
 					String critTypeID = getCriteria(0, session).criteria.getID();
 					categories.put(geo.getID(), geo.getCategories(critTypeID));
-					// address		
+					// address
 					BaseTopic address = geo.getAddress();
 					// if no related address put new hashtable in it for property city
-					Hashtable addressProps = address != null ? as.getTopicProperties(address) : new Hashtable(); 
+					Hashtable addressProps = address != null ? as.getTopicProperties(address) : new Hashtable();
 					addressProps.put(PROPERTY_CITY, geo.getCity());
 					addresses.put(geo.getID(), addressProps);
 				} catch (ClassCastException e) {
@@ -453,6 +461,44 @@
 		System.out.println(&quot;&gt; \&quot;hotspots\&quot; stored in session: institutions for &quot; + selCats.size() + &quot; categories&quot;);
 	}
 
+    /**
+     * nearly the same to setCategoryHotspots, except that it
+     * takes a catID as an argument and returns it index in the enumeration
+     */
+	private int setSearchedCategoryHotspots(Session session, String catId) {
+		String mapID = getCityMap(session).getID();
+		String instTypeID = getInstitutionType(session).getID();
+		Vector selCats = getSelectedCats(session);
+		//
+		Vector hotspots = new Vector();
+		Vector cluster = new Vector();
+		Enumeration e = selCats.elements();
+        int catIndex = 0;
+        int finalCatIndex = 0;
+		while (e.hasMoreElements()) {
+			String catID = (String) e.nextElement();
+            if (catId == catID) { finalCatIndex = catIndex; };
+			Vector presentables = cm.getRelatedViewTopics(mapID, 1, catID, ASSOCTYPE_ASSOCIATION, instTypeID, 1);
+			String icon;
+			if (getSearchMode(session).equals(&quot;0&quot;)) {	// ### first search criteria uses distinct visualization
+				icon = as.getLiveTopic(catID, 1).getIconfile();
+				if (icon.startsWith(&quot;ka-&quot;)) {	// use only small icon if standard Kiezatlas category icons is used
+					icon = icon.substring(0, icon.length() - 4) + &quot;-small.gif&quot;;		// ### could be property
+				}
+			} else {
+				icon = ICON_HOTSPOT;
+			}
+			presentables.insertElementAt(as.getCorporateWebBaseURL() + FILESERVER_ICONS_PATH + icon, 0);
+			hotspots.addElement(presentables);
+            catIndex++;
+		}
+		makeCluster(hotspots, cluster);
+		session.setAttribute(&quot;cluster&quot;, cluster);
+		session.setAttribute(&quot;hotspots&quot;, hotspots);
+		System.out.println(&quot;&gt; \&quot;hotspots\&quot; stored in session: institutions for &quot; + selCats.size() + &quot; categories&quot;);
+        return finalCatIndex;
+	}
+
 	// ---
 
 	/**
@@ -473,7 +519,7 @@
 	}
 
 	// ---
-	
+
 	/**
 	 * @param	hotspots should be a vector of vector of PresentableTopics
 	 * @param	cluster is first an empty vector, afterwards it should be a vector of clusters
@@ -495,7 +541,7 @@
 					// addPresentable, checks for doubles
 					foundCluster.addPresentable(currentPT);
 				} else {
-					// es gibt noch kein cluster oder es wurde kein passendes gefunden also suchen, 
+					// es gibt noch kein cluster oder es wurde kein passendes gefunden also suchen,
 					// nach dem ersten auftreten von dem gleichen Point in allen hotspots
 					PresentableTopic foundPT = findPT(currentPT, hotspots);
 					if ( foundPT != null ) {
@@ -507,10 +553,43 @@
 			}
 			// ### System.out.println(&quot;&gt; \&quot;clusters\&quot;: &quot;+clusters.toString());
 		}
+        //removeClusteredHotspots(hotspots, clusters);
 	}
-	
+
+    /** should remove a presentable from the hotspots vector when part of cluster
+     *  ### implement it the other way around
+     */
+    private void removeClusteredHotspots(Vector hotspots, Vector clusters) {
+        for (int i = 0; i &lt; hotspots.size(); i++) {
+            Vector topics = (Vector) hotspots.get(i);
+            Vector doubled = new Vector();
+            for (int j = 1; j &lt; topics.size(); j++) {
+                PresentableTopic topic = (PresentableTopic) topics.get(j);
+                if (isPartOfCluster(clusters, topic.getID())) {
+                    // topic is visible in cluster
+                    doubled.add(topic);
+                }
+            }
+            topics.removeAll(doubled);
+        }
+    }
+
+    private boolean isPartOfCluster(Vector clusters, String topicId) {
+        for (int i = 0; i &lt; clusters.size(); i++) {
+            Cluster object = (Cluster) clusters.get(i);
+            Vector topics = object.getPresentables();
+            for (int j = 0; j &lt; topics.size(); j++) {
+                PresentableTopic topic = (PresentableTopic) topics.get(j);
+                if (topic.getID().equals(topicId)) {
+                    return true;
+                }
+            }
+        }
+        return false;
+    }
+
 	private Cluster findAndCheckClusters(PresentableTopic currentPT, Vector clusters){
-			for (int c=0; c &lt; clusters.size(); c++) {	
+			for (int c=0; c &lt; clusters.size(); c++) {
 				// checking each cluster for point of current pt
 				Cluster currentCluster = (Cluster) clusters.get(c);
 				// ### System.out.println(currentCluster.presentables.size() + &quot; topics in current Cluster&quot; + currentCluster.getPoint());
@@ -522,7 +601,7 @@
 			}
 			return null;
 	}
-	
+
 	private PresentableTopic findPT(PresentableTopic pt, Vector hotspots) {
 		for(int p=0; p &lt; hotspots.size(); p++){
 			Vector scnd = (Vector)hotspots.get(p);
@@ -531,12 +610,12 @@
 				if (toCheck.getGeometry().equals(pt.getGeometry()) &amp; (!toCheck.getID().equals(pt.getID()))) {
 					// if the topics don't have the same id but have the same point, they belong together
 					return toCheck;
-				} 			
-			}			
-		}		
+				}
+			}
+		}
 		return null;
 	}
-	
+
 	// ---
 
 	private void toggleShapeDisplay(String shapeTypeID, Session session) {
@@ -561,7 +640,7 @@
 				ShapeType shapeType = (ShapeType) e.nextElement();
 				// if type is selected ...
 				if (shapeType.isSelected) {
-					// ... query all shapes and add Shape objects to the &quot;shapes&quot; vector 
+					// ... query all shapes and add Shape objects to the &quot;shapes&quot; vector
 					Vector shapeTopics = cm.getViewTopics(mapID, 1, shapeType.typeID);
 					Enumeration e2 = shapeTopics.elements();
 					while (e2.hasMoreElements()) {
@@ -636,4 +715,8 @@
 	private Vector getSelectedCats(Session session) {
 		return getCurrentCriteria(session).selectedCategoryIDs;
 	}
+
+    private void initSelectedCatAttribute(Session session) {
+        session.setAttribute(&quot;selectedCatId&quot;, null); // necessary for the new cityMap
+    }
 }

Modified: trunk/src/de/kiezatlas/deepamehta/ImportServlet.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/ImportServlet.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/ImportServlet.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -141,7 +141,7 @@
 		}
 	}
 
-    @Override
+    
     public void destroy() {
         // worker.done();
         worker.setThreadDead();

Modified: trunk/src/de/kiezatlas/deepamehta/ImportWorker.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/ImportWorker.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/ImportWorker.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -36,7 +36,7 @@
  * is a thread based worker which imports single projects and all occuring criterias resp. categories
  * from an xml interface into one kiezatlas workspace - it reuses topics (e.g. addresstopics) known to
  * the cm (by name), triggers a geolocation on each project with nice address
- * 
+ *
  * @author Malte Rei&#195;&#159;ig (<A HREF="https://lists.berlios.de/mailman/listinfo/kiezatlas-svn">mre at deepamehta.de</A>)
  */
 public class ImportWorker extends Thread implements DeepaMehtaConstants, KiezAtlas {
@@ -92,7 +92,7 @@
         } else {
             System.out.println(&quot;[ImportWorker] Thread named \&quot;&quot;+getName()+&quot;\&quot; is dead ----&quot;);
         }
-        
+
     }
 
     public void run() {
@@ -101,7 +101,7 @@
                 System.out.println(&quot;[ImportWorker] Thread \&quot;&quot;+this.getName()+&quot;\&quot; was kicked off for workspace \&quot;&quot; + workspaceId + &quot;\&quot; at &quot; + DeepaMehtaUtils.getTime().toString());
                 workerStarted = DeepaMehtaUtils.getTime(true);
                 // work here
-                String ehrenamtXml = sendGetRequest(&quot;<A HREF="http://ehrenamt.index.de/xml/index.cfm">http://ehrenamt.index.de/xml/index.cfm</A>&quot;, &quot;&quot;);
+                String ehrenamtXml = sendGetRequest(&quot;<A HREF="http://buerger-aktiv.index.de/kiezatlas/">http://buerger-aktiv.index.de/kiezatlas/</A>&quot;, &quot;&quot;);
                 if (ehrenamtXml != null) {
                     // delete former import
                     clearImport(); // clears workspace if new topics are available
@@ -174,8 +174,8 @@
         return workerStarted;
     }
 
-    /** completely remove all topics created by the last import 
-     *  e.g. delete from topicmap, delete related address topic, delete email topic, 
+    /** completely remove all topics created by the last import
+     *  e.g. delete from topicmap, delete related address topic, delete email topic,
      *  delete person topic, delete webpage topic, delete webpage topic if not used by any other topic ...
      */
     private void clearImport() {
@@ -369,9 +369,7 @@
         System.out.println(&quot;[ImportWorker] stored data at &quot;+DeepaMehtaUtils.getTime() +&quot; for a total no of &quot; + amountOfProjects + &quot; &quot; + getWorkspaceGeoType(workspaceId).getName());
     } catch (SAXParseException err) {
            System.out.println (&quot;** Parsing error&quot; + &quot;, line &quot;
-             + err.getLineNumber () + &quot;, uri &quot; + err.getSystemId ());
-        System.out.println(&quot; &quot; + err.getMessage ());
-
+             + err.getLineNumber () + &quot;, column &quot; + err.getColumnNumber() + &quot;, message: &quot; + err.getMessage());
     } catch (SAXException e) {
         Exception x = e.getException ();
         ((x == null) ? e : x).printStackTrace ();
@@ -536,12 +534,12 @@
 
     private Vector readInCategories(String catSeperatedValue) {
         Vector cats = new Vector();
-        while (catSeperatedValue.indexOf(&quot;,&quot;) != -1) {
-            int commaIndex = catSeperatedValue.indexOf(&quot;,&quot;);
+        while (catSeperatedValue.indexOf(&quot;;&quot;) != -1) {
+            int pointer = catSeperatedValue.indexOf(&quot;;&quot;);
             String catName, restName = &quot;&quot;;
-            if (commaIndex != -1) {
-                catName = catSeperatedValue.substring(0, commaIndex);
-                restName = catSeperatedValue.substring(commaIndex + 1);
+            if (pointer != -1) {
+                catName = catSeperatedValue.substring(0, pointer);
+                restName = catSeperatedValue.substring(pointer + 1);
                 cats.add(catName);
                 //System.out.println(&quot;&gt;&gt; cat: &quot; + catName + &quot; rest: &quot; + restName);
             }
@@ -566,7 +564,8 @@
                 System.out.println(&quot;[ImportWorker] sending request to: &quot; + url.toURI().toURL().toString());
                 URLConnection conn = url.openConnection();
                 // Get the response
-                BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream(), &quot;ISO-8859-1&quot;));
+                // BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream(), &quot;ISO-8859-1&quot;));
+                BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream(), &quot;UTF-8&quot;));
                 StringBuffer sb = new StringBuffer();
                 String line;
                 while ((line = rd.readLine()) != null) {
@@ -575,10 +574,19 @@
                 rd.close();
                 result = sb.toString();
                 System.out.println(&quot;[ImportWorker] finished loading data from &quot; + url);
+                DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
+                DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
+                Document doc = docBuilder.parse(new InputSource(new StringReader(result)));
             } catch(UnknownHostException uke) {
                 System.out.println(&quot;*** ImportWorker Thread could not load the xml data to import from &quot; + endpoint + &quot; message is: &quot; + uke.getMessage());
                 return null;
                 // done();
+            } catch (SAXParseException saxp) {
+                System.out.println (&quot;** Parsing error&quot; + &quot;, line &quot;
+                    + saxp.getLineNumber () + &quot;, column &quot; + saxp.getColumnNumber() + &quot;, message: &quot; + saxp.getMessage());
+                System.out.println(&quot;dataValue: &quot; +result.substring(saxp.getColumnNumber()-15, saxp.getColumnNumber()+50));
+                System.out.println(&quot;*** Import Worker is skipping the import for today !&quot;);
+                return null;
             } catch (Exception ex) {
                 System.out.println(&quot;*** ImportWorker Thread encountered problem: &quot; + ex.getMessage());
                 return null;
@@ -706,5 +714,5 @@
 
         return criterias;
     }
-    
+
 }
\ No newline at end of file

Modified: trunk/src/de/kiezatlas/deepamehta/KiezAtlas.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/KiezAtlas.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/KiezAtlas.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -222,7 +222,7 @@
 	public static final String ACTION_SHOW_CATEGORIES = &quot;showCategories&quot;;
 	public static final String ACTION_SHOW_INFO_EXTERNAL = &quot;showInfo&quot;;
 	public static final String ACTION_SHOW_GEO_INFO = &quot;showGeoObjectInfo&quot;;
-	public static final String ACTION_SEARCH = &quot;search&quot;;		
+	public static final String ACTION_SEARCH = &quot;search&quot;;
 	public static final String ACTION_SEARCH_BY_CATEGORY = &quot;searchByCategory&quot;;
 	public static final String ACTION_SELECT_CATEGORY = &quot;selectCategory&quot;;
 	public static final String ACTION_SHOW_GEO_FORUM = &quot;showGeoObjectForum&quot;;
@@ -248,6 +248,7 @@
 	public static final String ACTION_CLEAR_FILTER =&quot;clearFilter&quot;;
 	public static final String ACTION_CREATE_FORM_LETTER =&quot;createFormLetter&quot;;
 	public static final String ACTION_FILTER_ROUNDMAILING =&quot;filterRoundMailing&quot;;
+	public static final String ACTION_FILTER_MAIL_ALL =&quot;filterMailAll&quot;;
 	public static final String ACTION_CREATE_ROUNDMAILING =&quot;createRoundMailing&quot;;
 	public static final String ACTION_DELETE_ENTRY =&quot;deleteEntry&quot;;
 	public static final String ACTION_EXPORT_CITYMAP =&quot;exportCityMap&quot;;
@@ -258,10 +259,10 @@
     public static final String ACTION_SHOW_REPORT = &quot;showImportReport&quot;;
     public static final String ACTION_DO_IMPORT = &quot;doImport&quot;;
     public static final String ACTION_RESET_CRITERIAS = &quot;resetCritCats&quot;;
-	
 
 
 
+
 	// --------------------
 	// --- Search Modes ---
 	// --------------------

Modified: trunk/src/de/kiezatlas/deepamehta/KiezServlet.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/KiezServlet.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/KiezServlet.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -142,7 +142,7 @@
         Vector criterias = getKiezCriteriaTypes(workspaceId);
         BaseTopic geoType = getWorkspaceGeoType(workspaceId);
         Hashtable props = new Hashtable();
-        props.put(PROPERTY_NAME, query);       
+        props.put(PROPERTY_NAME, query);
         // String typeID, Hashtable propertyFilter, String topicmapID
         Vector results = cm.getTopics(geoType.getID(), props, topicmapId, false); // getTopic(query, props, topicmapId, directives);
         // getTopics: String typeID, String nameFilter, Hashtable propertyFilter, String relatedTopicID
@@ -198,7 +198,7 @@
         StringBuffer messages = null;
         StringBuffer result = new StringBuffer(&quot;{\&quot;result\&quot;: &quot;);
         StringBuffer mapTopics = new StringBuffer(&quot;{ \&quot;map\&quot;: \&quot;&quot; + mapId + &quot;\&quot;, \&quot;topics\&quot;: [&quot;);
-        // 
+        //
         BaseTopic geoType = (BaseTopic) getWorkspaceGeoType(workspaceId);
         Vector criterias = getKiezCriteriaTypes(workspaceId);
         Vector allTopics = cm.getTopics(geoType.getID(), new Hashtable(), mapId);
@@ -345,7 +345,7 @@
     /**
      * creates a list of categorizations for each slim topic
      * checks for each criteria type if one is directly associated with the category
-     * 
+     *
      * @param topicId
      * @param workspaceId
      * @return
@@ -450,34 +450,29 @@
      * @param workspaceId
      * @return
      */
-    private Vector getKiezCriteriaTypes(String workspaceId)
-    {
+    private Vector getKiezCriteriaTypes(String workspaceId) {
+        //
         Vector criterias = new Vector();
         TypeTopic critType = as.type(&quot;tt-ka-kriterium&quot;, 1);
         Vector subtypes = critType.getSubtypeIDs();
-        Vector workspacetypes = as.getRelatedTopics(workspaceId, &quot;at-uses&quot;, 2);
-        for(int i = 0; i &lt; workspacetypes.size(); i++)
-        {
+        Vector workspacetypes = as.getRelatedTopics(workspaceId, &quot;at-uses&quot;, critType.getID(), 2, true);
+        for ( int i = 0; i &lt; workspacetypes.size(); i++ ) {
             BaseTopic topic = (BaseTopic)workspacetypes.get(i);
-            for(int a = 0; a &lt; subtypes.size(); a++)
-            {
+            for ( int a = 0; a &lt; subtypes.size(); a++ ) {
                 String derivedOne = (String)subtypes.get(a);
-                if(derivedOne.equals(topic.getID()))
-                {
+                if ( derivedOne.equals(topic.getID()) ) {
                     //System.out.println(&quot;&gt;&gt;&gt; use criteria (&quot; + derivedOne + &quot;) &quot; + topic.getName());
                     criterias.add(topic);
                 }
             }
-
         }
-
         return criterias;
     }
 
     /**
-     * returns null if no topictype whihc is assigned to the given workspace, 
+     * returns null if no topictype whihc is assigned to the given workspace,
      * is a subtype of &quot;GeoObjectTopic&quot;
-     * 
+     *
      * @param workspaceId
      * @return
      */

Modified: trunk/src/de/kiezatlas/deepamehta/ListServlet.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/ListServlet.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/ListServlet.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -297,6 +297,22 @@
             mailBoxes.append(formerRecipients);
             session.setAttribute(&quot;recipients&quot;, mailBoxes.toString()); // --. update the linkedcontent
 			return PAGE_LIST_MAILING;
+		} else if (action.equals(ACTION_FILTER_MAIL_ALL)){
+            String cityMap = (String) session.getAttribute(&quot;cityMapID&quot;);
+            CityMapTopic map = (CityMapTopic) as.getLiveTopic(cityMap, 1); // live/base
+            //
+            Vector mapTopics = cm.getViewTopics(map.getID(), 1);
+            StringBuffer mailBoxes = new StringBuffer(&quot;&quot;);
+            if (mapTopics.size() &gt; 0) {
+                // ToDo check the Email property properly (Engagement Workspace?)
+                Vector mailTo = lookUpMailAdresses(mapTopics);
+                for (int j=0; j &lt; mailTo.size(); j++) {
+                    String mailBox = (String) mailTo.get(j);
+                    mailBoxes.append(mailTo.get(j) + &quot;, &quot;);
+                }
+            }
+			session.setAttribute(&quot;recipients&quot;, mailBoxes.toString());
+			return PAGE_LIST_MAILING;
 		} else if (action.equals(ACTION_DELETE_ENTRY)){
 			String topicId = params.getParameter(&quot;id&quot;);
 			deleteTopic(topicId);
@@ -400,7 +416,7 @@
 				Vector insts = cm.getTopicIDs(instTypeID, cityMapID, true);		// sortByTopicName=true
 				Vector topicBeans = new Vector();
 				for (int i = 0; i &lt; insts.size(); i++) {
-                    // Creates TopicBean 
+                    // Creates TopicBean
 					TopicBean topic = as.createTopicBean(insts.get(i).toString(), 1);
 					topicBeans.add(topic);
 				}
@@ -410,7 +426,7 @@
 				// fresh topic data &amp; re sorted
 				if (sortBy != null) {
 					sortBeans(topicBeans, sortBy);
-					System.out.println(&quot;&gt;&gt;&gt;&gt; topics are fresh from server and sorted by: &quot; 
+					System.out.println(&quot;&gt;&gt;&gt;&gt; topics are fresh from server and sorted by: &quot;
 						+ session.getAttribute(&quot;sortField&quot;) );
 				} else {
 					System.out.println(&quot;&gt;&gt;&gt;&gt; topics are fresh from server with sort ByTopic Name&quot;);
@@ -496,13 +512,13 @@
         geo.setGPSCoordinates(directives);
     }
 
-	
+
 	// **********************
 	// *** Custom Methods ***
 	// **********************
 
-	
 
+
 	private void sortBaseTopics(Vector baseTopics) {
 		// ### System.out.println(&quot;&gt;&gt;&gt; sorting for german strings supported&quot;);
 		Collections.sort(baseTopics, new MyTopicSort());
@@ -512,7 +528,7 @@
 		// ### System.out.println(&quot;&gt;&gt;&gt; sorting for german strings supported&quot;);
 		Collections.sort(topicBeans, new MyStringComparator( sortBy ));
 	}
-	
+
 	private Vector filterBeansByField(Vector topicBeans, String filterField, String filterText) {
 		Vector filteredBeans = new Vector();
 		//
@@ -523,7 +539,7 @@
 		for (int i = 0; i &lt; topicBeans.size(); i++) {
 			topicBean = (TopicBean) topicBeans.get(i);
 			beanField = (TopicBeanField) topicBean.getField(filterField);
-			// TopicBeanFields of TYPE_MULTI 
+			// TopicBeanFields of TYPE_MULTI
 			if (beanField.type == TopicBeanField.TYPE_MULTI) {
 				multiLoop:
 				for (int j = 0; j &lt; beanField.values.size(); j++) {
@@ -566,10 +582,10 @@
 		//
 		return filteredTopics;
 	}
-	
+
 	/**
-	 * Collects Email Addresses for all given beans by searching for TopicBeanFields {@link TopicBeanField} 
-	 * which are inherited by each bean as PROPERTY_EMAIL_ADDRESS as Email Topic (has to be named PROPERTY_EMAIL_ADDRESS) 
+	 * Collects Email Addresses for all given beans by searching for TopicBeanFields {@link TopicBeanField}
+	 * which are inherited by each bean as PROPERTY_EMAIL_ADDRESS as Email Topic (has to be named PROPERTY_EMAIL_ADDRESS)
 	 * and a TopicBeanField with the name &quot;Person / Email Address&quot; (Email of Person which is assigned to an Institution)
 	 * @param topics
 	 * @return a list of Strings which are all email adresses
@@ -682,7 +698,7 @@
     }
 
 	/** See getMailAddresses
-	 * 
+	 *
 	 * @param bean
 	 * @return
 	 */
@@ -693,7 +709,7 @@
 			// ### Value can be not null and just empty &quot;&quot; () have to verify this in the form processor
 			if (mailProp.value != null &amp;&amp; !mailProp.value.equals(&quot;&quot;)) {
 				// Type Single
-				// System.out.println(&quot;type single mail property is: &quot; + mailProp.value); 
+				// System.out.println(&quot;type single mail property is: &quot; + mailProp.value);
 				return mailProp.value;
 			} else if(mailProp.values != null &amp;&amp; mailProp.values.size() &gt; 0){
 				// Type Multi
@@ -722,9 +738,9 @@
 		}
 		return &quot;&quot;;
 	}
-	
+
 	/**
-	 * 
+	 *
 	 * @param topics
 	 * @return can be empty an empty string if the given topics were null
 	 */
@@ -770,16 +786,16 @@
 		}
 		return letter;
 	}
-	
+
 	private String createTab() {
 		return &quot;\t&quot;;
 	}
-	
+
 	/**
-	 * 
+	 *
 	 * Related Topic Name, if no relatedPerson looks for Related Info Properties on Person
 	 * If no Lastname is set an empty String is returned, normally Firstname Lastname without Gender
-	 * 
+	 *
 	 * @param bean
 	 * @return &lt;Code&gt;&quot;&quot;&lt;Code&gt; if no lastname is assigned to the person
 	 */
@@ -796,7 +812,7 @@
 				relatedPerson = person.getName();
 				return relatedPerson;
 			} else {
-				// System.out.println(&quot;&gt;&gt;&gt; createFormLetter:getRelatedPerson(): Related Topic Name is empty, found props: &quot; 
+				// System.out.println(&quot;&gt;&gt;&gt; createFormLetter:getRelatedPerson(): Related Topic Name is empty, found props: &quot;
 					// + lastName + &quot;, &quot;  +firstName);
 			}
 		} else if (lastName != null &amp;&amp; !lastName.equals(&quot;&quot;)) {
@@ -811,11 +827,11 @@
 		}
 		return relatedPerson;
 	}
-	
+
 	/**
 	 * Creates an address string with street, code, city divided by tabulator
 	 * Addresses are not allowed to be empty, Cities are. PostalCode is enough for us to send a letter.
-	 * 
+	 *
 	 * @param bean
 	 * @return &lt;Code&gt;null&lt;Code&gt; if no street and zip code could be found
 	 */
@@ -828,13 +844,13 @@
 		if (street != null &amp;&amp; postalCode != null) {
 			// if WEB_INFO_ is not deeply, beans do not have &quot;Address / Street&quot; as TopicBeanField. Street is named &quot;Address&quot; then
 			if (street.equals(&quot;&quot;) || postalCode.equals(&quot;&quot;)) {
-				// System.out.println(&quot;*** createFormLetter:skipAddr, neither street or postalCode was a 
+				// System.out.println(&quot;*** createFormLetter:skipAddr, neither street or postalCode was a
 					// provided as deep topicdata&quot;);
 				return null;
 			} else {
 				address = street + createTab() + postalCode + createTab();
 			}
-		// check for web_info related topic name 
+		// check for web_info related topic name
 		} else {
 			 Vector addresses= bean.getValues(&quot;Address&quot;);
 			 BaseTopic addressTopic = (BaseTopic) addresses.get(0);
@@ -854,7 +870,7 @@
 		} else if (citys != null &amp;&amp; citys.size() &gt; 0) { // != null &amp;&amp; cityField.type == TopicBeanField.TYPE_MULTI){
 				BaseTopic city = (BaseTopic) citys.get(0);
 				address += city.getName();
-				// System.out.println(&quot;**** found related city: &quot; + address.toString());	
+				// System.out.println(&quot;**** found related city: &quot; + address.toString());
 		// - no city data, but give berlin a plz try
 		} else {
 			if (postalCode != null) {
@@ -863,14 +879,14 @@
 				if (value &gt; 10001 &amp;&amp; value &lt;= 14199) {
 					// is within 10001 and 14199
 					System.out.println(&quot;*** createFormLetter: no city assigned to Address: &quot; + address + &quot;, but internal postal &quot; +
-						&quot;code check delivered \&quot;Berlin\&quot; as the city&quot;);	
+						&quot;code check delivered \&quot;Berlin\&quot; as the city&quot;);
 					address += &quot;Berlin&quot;;
 				}
 			}
 		}
 		return address;
 	}
-	
+
 	private Vector getWorkspaces(String userID, Session session) {
 		Vector workspaces = new Vector();
 		//
@@ -891,7 +907,7 @@
 		//
 		return workspaces;
 	}
-	
+
 	private boolean isKiezatlasWorkspace(String workspaceID) {
 		if (workspaceID.equals(WORKSPACE_KIEZATLAS)) {
 			return true;
@@ -1008,8 +1024,16 @@
     private void updateTopicInCache(GeoObjectTopic geo, Session session) {
         Vector topics = getCachedTopicList(session);
         for (int i=0; i &lt; topics.size(); i++) {
-            TopicBean t = (TopicBean) topics.get(i);
-            if (t.id.equals(geo.getID())) {
+            String topicId = &quot;&quot;;
+            try {
+                TopicBean t = ((TopicBean) topics.get(i));
+                topicId = t.id;
+            } catch (ClassCastException cex) {
+                System.out.println(&quot;&gt;&gt; CatchedClassCastException: of object &quot; + cex.getClass() + &quot;GeoObject: &quot; + ((GeoObjectTopic) topics.get(i)).getID());
+                topicId = ((GeoObjectTopic) topics.get(i)).getID();
+            }
+            // if (t instanceof TopicBean) { topicId = t.id } else { t }
+            if (topicId.equals(geo.getID())) {
                 topics.set(i, as.createTopicBean(geo.getID(), 1));
                 System.out.println(&quot;&gt;&gt;&gt;&gt; replaced topic (&quot;+geo.getID()+&quot;) in cache, inserted a fresh bean&quot;);
             }
@@ -1020,8 +1044,8 @@
     private void inserTopicIntoCache(GeoObjectTopic geo, Session session) {
         Vector topics = getCachedTopicList(session);
         TopicBean geoBean = as.createTopicBean(geo.getID(), 1);
-        topics.add(1, geoBean);
-        System.out.println(&quot;&gt;&gt;&gt;&gt; updated cache, inserted a fresh bean (&quot;+geo.getID()+&quot;) &quot;);
+        topics.add(1, geoBean); // put geoobject as bean in first place
+        System.out.println(&quot;&gt;&gt;&gt;&gt; updated cache, inserted a fresh bean (&quot;+geoBean.id+&quot;) &quot;);
         setCachedTopicList(topics, session);
     }
 
@@ -1039,7 +1063,7 @@
 
 	/**
 	 * Writes txt files with incremental number into the documents repository
-	 * 
+	 *
 	 * @param letter
 	 * @param fileName
 	 */
@@ -1092,9 +1116,10 @@
 	// --- Methods to maintain data in the session
 
     /**
-     * Stores the full List of Topics into the Session, independent of a filter. A filter always works on
-     * all elements in this list, so the user filter through all topics wether or not he has filtered before
-     * 
+     * Stores the full List of Topics into the Session, independent of a filter. If ACTION_FILTER is applied to this servlet and this session
+     * the calculations takes all elements in this list as abase: meaning that the filter operates alway on all topics wether or not
+     * it there was an ACTION_FILTER in session before
+     *
      * @param beans
      * @param session
      */
@@ -1102,7 +1127,7 @@
 		System.out.println(&quot;&gt;&gt;&gt; stored &quot; + beans.size() + &quot; \&quot;cachedTopics\&quot; in session&quot;);
 		session.setAttribute(&quot;cachedTopics&quot;, beans);
 	}
-	
+
 	private Vector getCachedTopicList(Session session) {
 		return (Vector) session.getAttribute(&quot;cachedTopics&quot;);
 	}
@@ -1126,7 +1151,7 @@
 		session.setAttribute(&quot;geo&quot;, geo);
 		System.out.println(&quot;&gt; \&quot;geo\&quot; stored in session: &quot; + geo);
 	}
-	
+
 	private void setSortByField(String field, Session session) {
 		session.setAttribute(&quot;sortField&quot;, field);
 		System.out.println(&quot;&gt; \&quot;sortField\&quot; stored in session: &quot; + field);
@@ -1142,22 +1167,22 @@
 		session.setAttribute(&quot;topics&quot;, beans);
 		System.out.println(&quot;&gt; \&quot;topics\&quot; stored in session: &quot; + beans.size());
 	}
-	
+
 	private void setFilterText(String value, Session session) {
 		session.setAttribute(&quot;filterText&quot;, value);
 		System.out.println(&quot;&gt; \&quot;filterText\&quot; stored in session: &quot; + value);
 	}
-	
+
 	private void setFilterField(String fieldName, Session session) {
 		session.setAttribute(&quot;filterField&quot;, fieldName);
 		System.out.println(&quot;&gt; \&quot;filterField\&quot; stored in session: &quot; + fieldName);
 	}
-	
+
 	private void setUseCache(Boolean flag, Session session) {
 		session.setAttribute(&quot;useCache&quot;, flag.toString());
 		System.out.println(&quot;&gt;&gt; \&quot;useCache\&quot; stored in session: &quot; + flag.toString());
 	}
-	
+
 	// ---
 
 	private CityMapTopic getCityMap(Session session) {
@@ -1171,20 +1196,20 @@
 	private GeoObjectTopic getGeoObject(Session session) {
 		return (GeoObjectTopic) as.getLiveTopic((BaseTopic) session.getAttribute(&quot;geo&quot;));
 	}
-	
+
 	/** Works just if sorting was once activated, uses session
-	 * 
+	 *
 	 * @param session
 	 * @return
 	 */
 	private String getSortByField(Session session) {
 		return (String) session.getAttribute(&quot;sortField&quot;);
 	}
-	
+
 	private Vector getListedTopics(Session session) {
 		return (Vector) session.getAttribute(&quot;topics&quot;);
 	}
-	
+
 	private Boolean isCacheUsed (Session session) {
 		if (session.getAttribute(&quot;useCache&quot;).equals(&quot;true&quot;)) {
 			return Boolean.TRUE;
@@ -1192,12 +1217,12 @@
 			return Boolean.FALSE;
 		}
 	}
-	
+
 	private String getFilterField(Session session) {
 		return (String) session.getAttribute(&quot;filterField&quot;);
 	}
 
-    
+
 	// ********************************
 	// *** Inner Comparison Classes ***
 	// ********************************
@@ -1205,13 +1230,13 @@
 
 
 	private class MyStringComparator implements Comparator {
-		
+
 		private String sortBy;
-		
+
 		public MyStringComparator(String sortBy) {
 			this.sortBy = sortBy;
 		}
-		
+
 		public int compare( Object o1, Object o2 ) {
 			TopicBean beanOne = (TopicBean) o1;
 			TopicBean beanTwo = (TopicBean) o2;
@@ -1231,10 +1256,10 @@
 			*/
 			return k; // ( 0 != i ) ? i : k;
 		}
-		
+
 		/**
 		 * Maybe not useful
-		 * 
+		 *
 		 * @param o
 		 * @return
 		 */
@@ -1285,5 +1310,5 @@
 		}
 
 	}
-	
+
 }

Modified: trunk/src/de/kiezatlas/deepamehta/topics/CityMapTopic.java
===================================================================
--- trunk/src/de/kiezatlas/deepamehta/topics/CityMapTopic.java	2010-05-19 21:19:19 UTC (rev 90)
+++ trunk/src/de/kiezatlas/deepamehta/topics/CityMapTopic.java	2010-07-09 23:06:45 UTC (rev 91)
@@ -33,7 +33,7 @@
 
 
 
-	static final String VERSION = &quot;1.6.2&quot;;
+	static final String VERSION = &quot;1.6.5&quot;;
 	static {
 		System.out.println(&quot;&gt;&gt;&gt; Kiezatlas &quot; + VERSION);
 	}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000080.html">[Kiezatlas-svn] r92 - in trunk: pages src/de/kiezatlas/deepamehta	src/de/kiezatlas/deepamehta/topics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#79">[ date ]</a>
              <a href="thread.html#79">[ thread ]</a>
              <a href="subject.html#79">[ subject ]</a>
              <a href="author.html#79">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiezatlas-svn">More information about the Kiezatlas-svn
mailing list</a><br>
</body></html>
